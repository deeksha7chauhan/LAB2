[0m20:13:16.600620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056edc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483fb60>]}


============================== 20:13:16.603948 | 29f3dfb7-f89d-4353-913a-4c42848a1471 ==============================
[0m20:13:16.603948 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:13:16.604351 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m20:13:16.609143 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m20:13:16.614451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.0926585, "process_user_time": 0.86516, "process_kernel_time": 0.257518, "process_mem_max_rss": "100433920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:13:16.614841 [debug] [MainThread]: Command `dbt run` failed at 20:13:16.614781 after 0.09 seconds
[0m20:13:16.615068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d87f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d87b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561b380>]}
[0m20:13:16.615268 [debug] [MainThread]: Flushing usage events
[0m20:18:56.136391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109250740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842ba10>]}


============================== 20:18:56.138587 | 9fb4dcfc-04fa-4e2b-97aa-e109f7350eff ==============================
[0m20:18:56.138587 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:56.138938 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m20:18:56.141401 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m20:18:56.143376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09267783, "process_user_time": 1.074738, "process_kernel_time": 0.373974, "process_mem_max_rss": "99975168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:18:56.143750 [debug] [MainThread]: Command `dbt run` failed at 20:18:56.143694 after 0.09 seconds
[0m20:18:56.143947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093196a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109792e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cbc20>]}
[0m20:18:56.144126 [debug] [MainThread]: Flushing usage events
[0m20:32:07.585269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c3cb0>]}


============================== 20:32:07.587538 | 2832df69-56d2-4437-882d-78ffd6c890b2 ==============================
[0m20:32:07.587538 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:32:07.587937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'empty': 'None', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt debug'}
[0m20:32:07.749231 [info ] [MainThread]: dbt version: 1.8.7
[0m20:32:07.749530 [info ] [MainThread]: python version: 3.12.4
[0m20:32:07.749682 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:32:07.749831 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:32:07.752612 [info ] [MainThread]: Using profiles dir at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics
[0m20:32:07.752791 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/profiles.yml
[0m20:32:07.752931 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/dbt_project.yml
[0m20:32:07.795888 [info ] [MainThread]: Configuration:
[0m20:32:07.796190 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m20:32:07.796346 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:32:07.796481 [info ] [MainThread]: Required dependencies:
[0m20:32:07.796728 [debug] [MainThread]: Executing "git --help"
[0m20:32:07.918945 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:32:07.919685 [debug] [MainThread]: STDERR: "b''"
[0m20:32:07.919904 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:32:07.920121 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:32:07.920282 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:32:07.920745 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m20:32:07.925973 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.41357872, "process_user_time": 1.013317, "process_kernel_time": 0.317507, "process_mem_max_rss": "103825408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:07.927289 [debug] [MainThread]: Command `dbt debug` failed at 20:32:07.927035 after 0.42 seconds
[0m20:32:07.928214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698aa20>]}
[0m20:32:07.928988 [debug] [MainThread]: Flushing usage events
[0m20:33:37.106284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ab3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc7c50>]}


============================== 20:33:37.108443 | a18ed8b1-4375-4090-9678-bdbc2d3f1aaa ==============================
[0m20:33:37.108443 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:33:37.108782 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:33:37.124038 [info ] [MainThread]: dbt version: 1.8.7
[0m20:33:37.124282 [info ] [MainThread]: python version: 3.12.4
[0m20:33:37.124433 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:33:37.124573 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:33:37.133496 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_WAREHOUSE'
[0m20:33:37.136993 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.094787, "process_user_time": 1.018121, "process_kernel_time": 0.319877, "process_mem_max_rss": "100450304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:33:37.137340 [debug] [MainThread]: Command `dbt debug` failed at 20:33:37.137283 after 0.10 seconds
[0m20:33:37.137540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b501a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc7d40>]}
[0m20:33:37.137741 [debug] [MainThread]: Flushing usage events
[0m20:35:19.764999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083fbc0>]}


============================== 20:35:19.767788 | 796a5ac1-aa65-42d7-a424-c5f56ef02558 ==============================
[0m20:35:19.767788 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:35:19.768278 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'empty': 'None', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:35:19.790883 [info ] [MainThread]: dbt version: 1.8.7
[0m20:35:19.791434 [info ] [MainThread]: python version: 3.12.4
[0m20:35:19.792032 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:35:19.792563 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:35:29.918317 [info ] [MainThread]: Using profiles dir at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics
[0m20:35:29.918967 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/profiles.yml
[0m20:35:29.919146 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/dbt_project.yml
[0m20:35:29.922627 [info ] [MainThread]: adapter type: snowflake
[0m20:35:29.923369 [info ] [MainThread]: adapter version: 1.8.4
[0m20:35:29.969842 [info ] [MainThread]: Configuration:
[0m20:35:29.970158 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:35:29.970319 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:35:29.970462 [info ] [MainThread]: Required dependencies:
[0m20:35:29.970746 [debug] [MainThread]: Executing "git --help"
[0m20:35:30.012919 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:35:30.013767 [debug] [MainThread]: STDERR: "b''"
[0m20:35:30.013966 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:35:30.014157 [info ] [MainThread]: Connection:
[0m20:35:30.014346 [info ] [MainThread]:   account: xnsewzu-hnb70227
[0m20:35:30.014486 [info ] [MainThread]:   user: nikswami
[0m20:35:30.014614 [info ] [MainThread]:   database: Nikhil@6868
[0m20:35:30.014741 [info ] [MainThread]:   warehouse: compute_wh
[0m20:35:30.014867 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:35:30.014996 [info ] [MainThread]:   schema: data
[0m20:35:30.015121 [info ] [MainThread]:   authenticator: None
[0m20:35:30.015240 [info ] [MainThread]:   oauth_client_id: None
[0m20:35:30.015359 [info ] [MainThread]:   query_tag: None
[0m20:35:30.015475 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:35:30.015591 [info ] [MainThread]:   host: None
[0m20:35:30.015711 [info ] [MainThread]:   port: None
[0m20:35:30.015822 [info ] [MainThread]:   proxy_host: None
[0m20:35:30.015937 [info ] [MainThread]:   proxy_port: None
[0m20:35:30.016048 [info ] [MainThread]:   protocol: None
[0m20:35:30.016159 [info ] [MainThread]:   connect_retries: 1
[0m20:35:30.016269 [info ] [MainThread]:   connect_timeout: None
[0m20:35:30.016379 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:35:30.016492 [info ] [MainThread]:   retry_all: False
[0m20:35:30.016601 [info ] [MainThread]:   insecure_mode: False
[0m20:35:30.016713 [info ] [MainThread]:   reuse_connections: None
[0m20:35:30.017102 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:35:30.027590 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:35:30.029824 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:35:30.030024 [debug] [MainThread]: On debug: select 1 as id
[0m20:35:30.030510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:30.776377 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m20:35:30.778152 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m20:35:30.779301 [debug] [MainThread]: On debug: No close available on handle
[0m20:35:30.780119 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:35:30.780704 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:35:30.781177 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: xnsewzu-hnb70227.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:35:30.787963 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 11.097418, "process_user_time": 3.244903, "process_kernel_time": 2.423722, "process_mem_max_rss": "193298432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:30.788997 [debug] [MainThread]: Command `dbt debug` failed at 20:35:30.788816 after 11.10 seconds
[0m20:35:30.789580 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:35:30.790096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111027bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12777e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110faf200>]}
[0m20:35:30.790659 [debug] [MainThread]: Flushing usage events
[0m20:38:39.087480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dac620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104742570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104743d10>]}


============================== 20:38:39.090876 | af8290da-d40a-46f2-8a8d-296933f1fcf3 ==============================
[0m20:38:39.090876 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:38:39.091289 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'log_format': 'default', 'empty': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:38:39.130145 [info ] [MainThread]: dbt version: 1.8.7
[0m20:38:39.130591 [info ] [MainThread]: python version: 3.12.4
[0m20:38:39.130782 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:38:39.130960 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:38:40.966102 [info ] [MainThread]: Using profiles dir at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics
[0m20:38:40.966597 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/profiles.yml
[0m20:38:40.966771 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/dbt_project.yml
[0m20:38:40.967526 [info ] [MainThread]: adapter type: snowflake
[0m20:38:40.967726 [info ] [MainThread]: adapter version: 1.8.4
[0m20:38:41.008430 [info ] [MainThread]: Configuration:
[0m20:38:41.008732 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:38:41.008892 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:38:41.009028 [info ] [MainThread]: Required dependencies:
[0m20:38:41.009266 [debug] [MainThread]: Executing "git --help"
[0m20:38:41.049130 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:38:41.050017 [debug] [MainThread]: STDERR: "b''"
[0m20:38:41.050220 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:38:41.050414 [info ] [MainThread]: Connection:
[0m20:38:41.050594 [info ] [MainThread]:   account: XNSEWZU-HNB70227
[0m20:38:41.050743 [info ] [MainThread]:   user: nikswami
[0m20:38:41.050878 [info ] [MainThread]:   database: Nikhil@6868
[0m20:38:41.050999 [info ] [MainThread]:   warehouse: compute_wh
[0m20:38:41.051114 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:38:41.051230 [info ] [MainThread]:   schema: data
[0m20:38:41.051350 [info ] [MainThread]:   authenticator: None
[0m20:38:41.051465 [info ] [MainThread]:   oauth_client_id: None
[0m20:38:41.051579 [info ] [MainThread]:   query_tag: None
[0m20:38:41.051693 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:38:41.051805 [info ] [MainThread]:   host: None
[0m20:38:41.051919 [info ] [MainThread]:   port: None
[0m20:38:41.052031 [info ] [MainThread]:   proxy_host: None
[0m20:38:41.052144 [info ] [MainThread]:   proxy_port: None
[0m20:38:41.052256 [info ] [MainThread]:   protocol: None
[0m20:38:41.052366 [info ] [MainThread]:   connect_retries: 1
[0m20:38:41.052477 [info ] [MainThread]:   connect_timeout: None
[0m20:38:41.052589 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:38:41.052700 [info ] [MainThread]:   retry_all: False
[0m20:38:41.052810 [info ] [MainThread]:   insecure_mode: False
[0m20:38:41.052920 [info ] [MainThread]:   reuse_connections: None
[0m20:38:41.053245 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:38:41.061143 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:38:41.063095 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:38:41.063269 [debug] [MainThread]: On debug: select 1 as id
[0m20:38:41.063424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:41.480906 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m20:38:41.481705 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m20:38:41.482202 [debug] [MainThread]: On debug: No close available on handle
[0m20:38:41.482693 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:38:41.483165 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:38:41.483556 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: XNSEWZU-HNB70227.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:38:41.490904 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.4902725, "process_user_time": 2.910375, "process_kernel_time": 1.57468, "process_mem_max_rss": "193413120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:41.491763 [debug] [MainThread]: Command `dbt debug` failed at 20:38:41.491621 after 2.49 seconds
[0m20:38:41.492275 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:38:41.492765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa06180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e23da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de7da0>]}
[0m20:38:41.493341 [debug] [MainThread]: Flushing usage events
[0m20:40:56.242910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eceed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecfce0>]}


============================== 20:40:56.245350 | b96c9440-6ffb-4475-9e03-8337b31e29a0 ==============================
[0m20:40:56.245350 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:40:56.245803 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'target_path': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m20:40:56.263066 [info ] [MainThread]: dbt version: 1.8.7
[0m20:40:56.263368 [info ] [MainThread]: python version: 3.12.4
[0m20:40:56.263526 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:40:56.263672 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:40:58.029104 [info ] [MainThread]: Using profiles dir at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics
[0m20:40:58.029448 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/profiles.yml
[0m20:40:58.029632 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/dbt_project.yml
[0m20:40:58.031746 [info ] [MainThread]: adapter type: snowflake
[0m20:40:58.031973 [info ] [MainThread]: adapter version: 1.8.4
[0m20:40:58.073313 [info ] [MainThread]: Configuration:
[0m20:40:58.073635 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:58.073798 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:58.073930 [info ] [MainThread]: Required dependencies:
[0m20:40:58.074296 [debug] [MainThread]: Executing "git --help"
[0m20:40:58.116403 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:58.116978 [debug] [MainThread]: STDERR: "b''"
[0m20:40:58.117166 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:58.117351 [info ] [MainThread]: Connection:
[0m20:40:58.117537 [info ] [MainThread]:   account: XNSEWZU-HNB70227
[0m20:40:58.117669 [info ] [MainThread]:   user: NIKSWAMI
[0m20:40:58.117789 [info ] [MainThread]:   database: Nikhil@6868
[0m20:40:58.117907 [info ] [MainThread]:   warehouse: compute_wh
[0m20:40:58.118030 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:40:58.118146 [info ] [MainThread]:   schema: data
[0m20:40:58.118262 [info ] [MainThread]:   authenticator: None
[0m20:40:58.118380 [info ] [MainThread]:   oauth_client_id: None
[0m20:40:58.118494 [info ] [MainThread]:   query_tag: None
[0m20:40:58.118610 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:40:58.118725 [info ] [MainThread]:   host: None
[0m20:40:58.118839 [info ] [MainThread]:   port: None
[0m20:40:58.118950 [info ] [MainThread]:   proxy_host: None
[0m20:40:58.119064 [info ] [MainThread]:   proxy_port: None
[0m20:40:58.119174 [info ] [MainThread]:   protocol: None
[0m20:40:58.119284 [info ] [MainThread]:   connect_retries: 1
[0m20:40:58.119402 [info ] [MainThread]:   connect_timeout: None
[0m20:40:58.119512 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:40:58.119625 [info ] [MainThread]:   retry_all: False
[0m20:40:58.119734 [info ] [MainThread]:   insecure_mode: False
[0m20:40:58.119844 [info ] [MainThread]:   reuse_connections: None
[0m20:40:58.120184 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:40:58.129819 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:40:58.131992 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:40:58.132171 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:58.132328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:58.556119 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m20:40:58.556763 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m20:40:58.557177 [debug] [MainThread]: On debug: No close available on handle
[0m20:40:58.557582 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:40:58.557980 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:40:58.558308 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: XNSEWZU-HNB70227.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:40:58.569618 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.3974438, "process_user_time": 2.623178, "process_kernel_time": 1.306516, "process_mem_max_rss": "192217088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:58.570558 [debug] [MainThread]: Command `dbt debug` failed at 20:40:58.570400 after 2.40 seconds
[0m20:40:58.571076 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:58.571549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d48db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f277950>]}
[0m20:40:58.572091 [debug] [MainThread]: Flushing usage events
[0m20:43:19.917361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438a6c0>]}


============================== 20:43:19.919495 | 2f6ee2b1-a5a8-4650-b78c-11ea393961c1 ==============================
[0m20:43:19.919495 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:43:19.919937 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'empty': 'None', 'no_print': 'None', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True'}
[0m20:43:19.937879 [info ] [MainThread]: dbt version: 1.8.7
[0m20:43:19.938159 [info ] [MainThread]: python version: 3.12.4
[0m20:43:19.938307 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:43:19.938442 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:43:22.075380 [info ] [MainThread]: Using profiles dir at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics
[0m20:43:22.075741 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/profiles.yml
[0m20:43:22.075954 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/dbt_project.yml
[0m20:43:22.077991 [info ] [MainThread]: adapter type: snowflake
[0m20:43:22.078240 [info ] [MainThread]: adapter version: 1.8.4
[0m20:43:22.121274 [info ] [MainThread]: Configuration:
[0m20:43:22.121587 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:43:22.121737 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:43:22.121870 [info ] [MainThread]: Required dependencies:
[0m20:43:22.122206 [debug] [MainThread]: Executing "git --help"
[0m20:43:22.160330 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:43:22.160997 [debug] [MainThread]: STDERR: "b''"
[0m20:43:22.161214 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:43:22.161403 [info ] [MainThread]: Connection:
[0m20:43:22.161581 [info ] [MainThread]:   account: XNSEWZU-HNB70227
[0m20:43:22.161707 [info ] [MainThread]:   user: NIKSWAMI
[0m20:43:22.161831 [info ] [MainThread]:   database: stock
[0m20:43:22.161946 [info ] [MainThread]:   warehouse: compute_wh
[0m20:43:22.162065 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:43:22.162183 [info ] [MainThread]:   schema: data
[0m20:43:22.162300 [info ] [MainThread]:   authenticator: None
[0m20:43:22.162414 [info ] [MainThread]:   oauth_client_id: None
[0m20:43:22.162525 [info ] [MainThread]:   query_tag: None
[0m20:43:22.162636 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:43:22.162751 [info ] [MainThread]:   host: None
[0m20:43:22.162864 [info ] [MainThread]:   port: None
[0m20:43:22.162973 [info ] [MainThread]:   proxy_host: None
[0m20:43:22.163087 [info ] [MainThread]:   proxy_port: None
[0m20:43:22.163197 [info ] [MainThread]:   protocol: None
[0m20:43:22.163309 [info ] [MainThread]:   connect_retries: 1
[0m20:43:22.163420 [info ] [MainThread]:   connect_timeout: None
[0m20:43:22.163538 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:43:22.163648 [info ] [MainThread]:   retry_all: False
[0m20:43:22.163756 [info ] [MainThread]:   insecure_mode: False
[0m20:43:22.163865 [info ] [MainThread]:   reuse_connections: None
[0m20:43:22.164192 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:43:22.173260 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:43:22.174561 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:43:22.174746 [debug] [MainThread]: On debug: select 1 as id
[0m20:43:22.174932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:22.659769 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m20:43:22.661045 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m20:43:22.661727 [debug] [MainThread]: On debug: No close available on handle
[0m20:43:22.662429 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:43:22.663583 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:43:22.664188 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: XNSEWZU-HNB70227.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:43:22.671189 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.8433423, "process_user_time": 3.021098, "process_kernel_time": 1.127736, "process_mem_max_rss": "192053248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:43:22.672165 [debug] [MainThread]: Command `dbt debug` failed at 20:43:22.671989 after 2.84 seconds
[0m20:43:22.672730 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:43:22.673254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9aad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e473a70>]}
[0m20:43:22.673822 [debug] [MainThread]: Flushing usage events
[0m20:44:56.971604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105733200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cfe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cfc20>]}


============================== 20:44:56.973891 | 5f6fd52b-aa7c-4c3b-8f8d-aa7e2a1bf636 ==============================
[0m20:44:56.973891 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:44:56.974265 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'None', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False'}
[0m20:44:56.989651 [info ] [MainThread]: dbt version: 1.8.7
[0m20:44:56.989882 [info ] [MainThread]: python version: 3.12.4
[0m20:44:56.990037 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m20:44:56.990173 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m20:44:58.926923 [info ] [MainThread]: Using profiles dir at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics
[0m20:44:58.927205 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/profiles.yml
[0m20:44:58.927364 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/dbt_project.yml
[0m20:44:58.929069 [info ] [MainThread]: adapter type: snowflake
[0m20:44:58.929265 [info ] [MainThread]: adapter version: 1.8.4
[0m20:44:58.967159 [info ] [MainThread]: Configuration:
[0m20:44:58.967469 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:44:58.967620 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:44:58.967753 [info ] [MainThread]: Required dependencies:
[0m20:44:58.968045 [debug] [MainThread]: Executing "git --help"
[0m20:44:59.006608 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:44:59.007562 [debug] [MainThread]: STDERR: "b''"
[0m20:44:59.007762 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:44:59.007951 [info ] [MainThread]: Connection:
[0m20:44:59.008133 [info ] [MainThread]:   account: XNSEWZU-HNB70227
[0m20:44:59.008266 [info ] [MainThread]:   user: NIKSWAMI
[0m20:44:59.008391 [info ] [MainThread]:   database: stock
[0m20:44:59.008515 [info ] [MainThread]:   warehouse: compute_wh
[0m20:44:59.008636 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:44:59.008756 [info ] [MainThread]:   schema: data
[0m20:44:59.008878 [info ] [MainThread]:   authenticator: None
[0m20:44:59.008997 [info ] [MainThread]:   oauth_client_id: None
[0m20:44:59.009113 [info ] [MainThread]:   query_tag: None
[0m20:44:59.009229 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:44:59.009344 [info ] [MainThread]:   host: None
[0m20:44:59.009462 [info ] [MainThread]:   port: None
[0m20:44:59.009589 [info ] [MainThread]:   proxy_host: None
[0m20:44:59.009706 [info ] [MainThread]:   proxy_port: None
[0m20:44:59.009825 [info ] [MainThread]:   protocol: None
[0m20:44:59.009941 [info ] [MainThread]:   connect_retries: 1
[0m20:44:59.010064 [info ] [MainThread]:   connect_timeout: None
[0m20:44:59.010180 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:44:59.010298 [info ] [MainThread]:   retry_all: False
[0m20:44:59.010412 [info ] [MainThread]:   insecure_mode: False
[0m20:44:59.010531 [info ] [MainThread]:   reuse_connections: None
[0m20:44:59.010992 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:44:59.024978 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:44:59.026563 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:44:59.026785 [debug] [MainThread]: On debug: select 1 as id
[0m20:44:59.026976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:59.630241 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.603 seconds
[0m20:44:59.633325 [debug] [MainThread]: On debug: Close
[0m20:44:59.759804 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:44:59.761286 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:44:59.769417 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.856921, "process_user_time": 2.633105, "process_kernel_time": 1.304653, "process_mem_max_rss": "192217088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:44:59.770482 [debug] [MainThread]: Command `dbt debug` succeeded at 20:44:59.770296 after 2.86 seconds
[0m20:44:59.771062 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:44:59.771602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1018572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118130950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064478f0>]}
[0m20:44:59.772183 [debug] [MainThread]: Flushing usage events
[0m21:49:36.403654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bef770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fcbbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fcbec0>]}


============================== 21:49:36.406757 | 10523b82-0053-4409-9eab-209bb3abb864 ==============================
[0m21:49:36.406757 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:49:36.407188 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'quiet': 'False', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m21:49:38.217007 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "snowflake", target "dev" invalid: Undefined is not of type 'string'
[0m21:49:38.222971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8990108, "process_user_time": 2.419296, "process_kernel_time": 1.275134, "process_mem_max_rss": "184303616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:38.223419 [debug] [MainThread]: Command `dbt run` failed at 21:49:38.223345 after 1.90 seconds
[0m21:49:38.223676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1660abd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ba14f0>]}
[0m21:49:38.223933 [debug] [MainThread]: Flushing usage events
[0m21:51:37.703406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114053380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113340a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113343cb0>]}


============================== 21:51:37.707027 | 558c440e-ac4e-4718-b8fa-8e1c1deb81fd ==============================
[0m21:51:37.707027 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:51:37.707452 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default'}
[0m21:51:39.699455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '558c440e-ac4e-4718-b8fa-8e1c1deb81fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146f5c10>]}
[0m21:51:39.723085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '558c440e-ac4e-4718-b8fa-8e1c1deb81fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16307d6a0>]}
[0m21:51:39.725288 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:51:39.746386 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:51:39.751033 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:51:39.751293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '558c440e-ac4e-4718-b8fa-8e1c1deb81fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114412990>]}
[0m21:51:40.416192 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:51:40.416520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '558c440e-ac4e-4718-b8fa-8e1c1deb81fd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16857e900>]}
[0m21:51:40.533125 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_project.stock_analysis' (models/transformations/stock_analysis.sql) depends on a node named 'raw.stock_data' which was not found
[0m21:51:40.539545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9237773, "process_user_time": 3.156498, "process_kernel_time": 1.305292, "process_mem_max_rss": "197754880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:51:40.539878 [debug] [MainThread]: Command `dbt run` failed at 21:51:40.539822 after 2.92 seconds
[0m21:51:40.540093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681e12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168161d90>]}
[0m21:51:40.540280 [debug] [MainThread]: Flushing usage events
[0m21:55:09.815144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ac530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcbfb0>]}


============================== 21:55:09.817935 | c1393306-b44e-42da-8c4b-4d29880890bd ==============================
[0m21:55:09.817935 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:55:09.818536 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt run'}
[0m21:55:11.685230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1393306-b44e-42da-8c4b-4d29880890bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0bde50>]}
[0m21:55:11.708460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1393306-b44e-42da-8c4b-4d29880890bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd37c20>]}
[0m21:55:11.710357 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:55:11.730770 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:55:11.734574 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:55:11.734845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1393306-b44e-42da-8c4b-4d29880890bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9da870>]}
[0m21:55:12.390768 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:55:12.391100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1393306-b44e-42da-8c4b-4d29880890bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe60500>]}
[0m21:55:12.507621 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_project.stock_mart' (models/marts/stock_mart.sql) depends on a node named 'transformations.stock_analysis' which was not found
[0m21:55:12.513606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7919328, "process_user_time": 3.364734, "process_kernel_time": 1.346774, "process_mem_max_rss": "198705152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:12.513936 [debug] [MainThread]: Command `dbt run` failed at 21:55:12.513881 after 2.79 seconds
[0m21:55:12.514152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e67a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb4b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff32600>]}
[0m21:55:12.514338 [debug] [MainThread]: Flushing usage events
[0m21:56:18.452232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a9fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a9fd70>]}


============================== 21:56:18.455492 | 214015de-1a0f-46a7-baeb-a1eea04028e8 ==============================
[0m21:56:18.455492 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:56:18.455905 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'empty': 'False', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'log_format': 'default', 'debug': 'False', 'version_check': 'True'}
[0m21:56:20.631834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '214015de-1a0f-46a7-baeb-a1eea04028e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b15da30>]}
[0m21:56:20.655092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '214015de-1a0f-46a7-baeb-a1eea04028e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a524da0>]}
[0m21:56:20.657040 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:56:20.677421 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:56:20.680805 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:56:20.681055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '214015de-1a0f-46a7-baeb-a1eea04028e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057243b0>]}
[0m21:56:21.305627 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:56:21.305996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '214015de-1a0f-46a7-baeb-a1eea04028e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9e2840>]}
[0m21:56:21.438028 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_project.stock_snapshot' (snapshots/stock_snapshot.sql) depends on a node named 'raw.stock_data' which was not found
[0m21:56:21.443888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0752196, "process_user_time": 3.153717, "process_kernel_time": 1.408034, "process_mem_max_rss": "199229440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:21.444227 [debug] [MainThread]: Command `dbt run` failed at 21:56:21.444172 after 3.08 seconds
[0m21:56:21.444445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bba1b80>]}
[0m21:56:21.444632 [debug] [MainThread]: Flushing usage events
[0m21:56:55.962413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c434a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e208f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e23cb0>]}


============================== 21:56:55.965590 | 1a5e6481-5c3c-4b5c-b418-56f780e6d71e ==============================
[0m21:56:55.965590 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:56:55.966049 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'warn_error': 'None', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:56:57.603911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed5d00>]}
[0m21:56:57.627090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e81010>]}
[0m21:56:57.628301 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:56:57.642282 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:56:57.643809 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:56:57.644078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13639b2c0>]}
[0m21:56:58.275766 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:56:58.276207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f795e0>]}
[0m21:56:58.421701 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_project.stock_tests' (tests/stock_tests.sql) depends on a node named 'raw.stock_data' in package '' which was not found
[0m21:56:58.422037 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_project.stock_tests' (tests/stock_tests.sql) depends on a node named 'raw.stock_data' in package '' which was not found
[0m21:56:58.476539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14182acf0>]}
[0m21:56:58.598320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ff05c0>]}
[0m21:56:58.598747 [info ] [MainThread]: Found 3 models, 1 snapshot, 9 data tests, 1 source, 460 macros
[0m21:56:58.599000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14197c080>]}
[0m21:56:58.600195 [info ] [MainThread]: 
[0m21:56:58.600596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:56:58.603398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m21:56:58.611583 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m21:56:58.611834 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m21:56:58.612025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:59.207412 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.595 seconds
[0m21:56:59.211700 [debug] [ThreadPool]: On list_stock: Close
[0m21:56:59.317759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_stock_data)
[0m21:56:59.318451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_snapshots'
[0m21:56:59.324871 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m21:56:59.326176 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m21:56:59.326521 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m21:56:59.326730 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m21:56:59.326908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:59.327069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:59.787391 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.460 seconds
[0m21:56:59.790714 [debug] [ThreadPool]: On list_stock_data: Close
[0m21:56:59.832898 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85664-0004-2cb8-0000-0002756fa651
[0m21:56:59.833848 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:56:59.834748 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:56:59.835468 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:56:59.836062 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m21:56:59.947230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14185cce0>]}
[0m21:56:59.948550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:59.949274 [info ] [MainThread]: 
[0m21:56:59.957432 [debug] [Thread-1 (]: Began running node model.stock_project.stock_data
[0m21:56:59.958389 [info ] [Thread-1 (]: 1 of 3 START sql table model data.stock_data ................................... [RUN]
[0m21:56:59.959096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_project.stock_data)
[0m21:56:59.959614 [debug] [Thread-1 (]: Began compiling node model.stock_project.stock_data
[0m21:56:59.969050 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_project.stock_data"
[0m21:56:59.975366 [debug] [Thread-1 (]: Began executing node model.stock_project.stock_data
[0m21:57:00.004943 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_project.stock_data"
[0m21:57:00.007948 [debug] [Thread-1 (]: Using snowflake connection "model.stock_project.stock_data"
[0m21:57:00.008338 [debug] [Thread-1 (]: On model.stock_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.stock_project.stock_data"} */
create or replace transient table stock.data.stock_data
         as
        (-- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
        );
[0m21:57:00.008650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:01.783749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.775 seconds
[0m21:57:01.802219 [debug] [Thread-1 (]: On model.stock_project.stock_data: Close
[0m21:57:01.904717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c6f710>]}
[0m21:57:01.905959 [info ] [Thread-1 (]: 1 of 3 OK created sql table model data.stock_data .............................. [[32mSUCCESS 1[0m in 1.94s]
[0m21:57:01.906918 [debug] [Thread-1 (]: Finished running node model.stock_project.stock_data
[0m21:57:01.908124 [debug] [Thread-3 (]: Began running node model.stock_project.stock_analysis
[0m21:57:01.909180 [info ] [Thread-3 (]: 2 of 3 START sql table model data.stock_analysis ............................... [RUN]
[0m21:57:01.909952 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.stock_project.stock_analysis'
[0m21:57:01.910454 [debug] [Thread-3 (]: Began compiling node model.stock_project.stock_analysis
[0m21:57:01.913736 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_project.stock_analysis"
[0m21:57:01.915692 [debug] [Thread-3 (]: Began executing node model.stock_project.stock_analysis
[0m21:57:01.918501 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_project.stock_analysis"
[0m21:57:01.920953 [debug] [Thread-3 (]: Using snowflake connection "model.stock_project.stock_analysis"
[0m21:57:01.921460 [debug] [Thread-3 (]: On model.stock_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.stock_project.stock_analysis"} */
create or replace transient table stock.data.stock_analysis
         as
        (-- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
        );
[0m21:57:01.921898 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:03.318015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.396 seconds
[0m21:57:03.323319 [debug] [Thread-3 (]: On model.stock_project.stock_analysis: Close
[0m21:57:03.436395 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1420c8aa0>]}
[0m21:57:03.437595 [info ] [Thread-3 (]: 2 of 3 OK created sql table model data.stock_analysis .......................... [[32mSUCCESS 1[0m in 1.53s]
[0m21:57:03.438671 [debug] [Thread-3 (]: Finished running node model.stock_project.stock_analysis
[0m21:57:03.439929 [debug] [Thread-2 (]: Began running node model.stock_project.stock_mart
[0m21:57:03.441031 [info ] [Thread-2 (]: 3 of 3 START sql table model data.stock_mart ................................... [RUN]
[0m21:57:03.441900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now model.stock_project.stock_mart)
[0m21:57:03.442243 [debug] [Thread-2 (]: Began compiling node model.stock_project.stock_mart
[0m21:57:03.444738 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_project.stock_mart"
[0m21:57:03.446375 [debug] [Thread-2 (]: Began executing node model.stock_project.stock_mart
[0m21:57:03.448329 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_project.stock_mart"
[0m21:57:03.450469 [debug] [Thread-2 (]: Using snowflake connection "model.stock_project.stock_mart"
[0m21:57:03.450877 [debug] [Thread-2 (]: On model.stock_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.stock_project.stock_mart"} */
create or replace transient table stock.data.stock_mart
         as
        (-- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
        );
[0m21:57:03.451143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:57:04.754593 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.303 seconds
[0m21:57:04.759720 [debug] [Thread-2 (]: On model.stock_project.stock_mart: Close
[0m21:57:04.875682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5e6481-5c3c-4b5c-b418-56f780e6d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14214b890>]}
[0m21:57:04.877452 [info ] [Thread-2 (]: 3 of 3 OK created sql table model data.stock_mart .............................. [[32mSUCCESS 1[0m in 1.43s]
[0m21:57:04.878740 [debug] [Thread-2 (]: Finished running node model.stock_project.stock_mart
[0m21:57:04.880738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:04.881298 [debug] [MainThread]: Connection 'model.stock_project.stock_data' was properly closed.
[0m21:57:04.881659 [debug] [MainThread]: Connection 'model.stock_project.stock_mart' was properly closed.
[0m21:57:04.881991 [debug] [MainThread]: Connection 'model.stock_project.stock_analysis' was properly closed.
[0m21:57:04.882502 [info ] [MainThread]: 
[0m21:57:04.882935 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m21:57:04.884077 [debug] [MainThread]: Command end result
[0m21:57:04.988188 [info ] [MainThread]: 
[0m21:57:04.988761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:04.989106 [info ] [MainThread]: 
[0m21:57:04.989447 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:57:04.994022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.117342, "process_user_time": 3.893218, "process_kernel_time": 1.525463, "process_mem_max_rss": "209059840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:04.994724 [debug] [MainThread]: Command `dbt run` succeeded at 21:57:04.994619 after 9.12 seconds
[0m21:57:04.995113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eabcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104933260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d43230>]}
[0m21:57:04.995478 [debug] [MainThread]: Flushing usage events
[0m21:57:51.116456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070838f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cbfb0>]}


============================== 21:57:51.119289 | 39f24ca3-0304-4a91-864f-d53e8686f883 ==============================
[0m21:57:51.119289 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:57:51.119916 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'log_path': '/Users/spartan/Documents/Data_Warehouse/lab2_stock_analytics/logs', 'invocation_command': 'dbt run', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m21:57:53.238713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4f500>]}
[0m21:57:53.262471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0eab0>]}
[0m21:57:53.264533 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:57:53.292593 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:57:53.483162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:53.483565 [debug] [MainThread]: Partial parsing: updated file: stock_project://tests/stock_tests.sql
[0m21:57:53.578006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13471cb00>]}
[0m21:57:53.689617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a8ff20>]}
[0m21:57:53.690029 [info ] [MainThread]: Found 3 models, 1 snapshot, 10 data tests, 1 source, 460 macros
[0m21:57:53.690292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ad2d80>]}
[0m21:57:53.691493 [info ] [MainThread]: 
[0m21:57:53.691904 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:57:53.694618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m21:57:53.702501 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m21:57:53.702729 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m21:57:53.702912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:54.307629 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.604 seconds
[0m21:57:54.311769 [debug] [ThreadPool]: On list_stock: Close
[0m21:57:54.413160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m21:57:54.414302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m21:57:54.426402 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m21:57:54.428836 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m21:57:54.429286 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m21:57:54.429686 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m21:57:54.430092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:54.430408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:54.960482 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.530 seconds
[0m21:57:54.964433 [debug] [ThreadPool]: On list_stock_data: Close
[0m21:57:54.981252 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85665-0004-26b4-0000-0002756f7699
[0m21:57:54.981849 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:57:54.982518 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:57:54.982940 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:57:54.983379 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m21:57:55.090707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ca3740>]}
[0m21:57:55.091967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:55.092641 [info ] [MainThread]: 
[0m21:57:55.097458 [debug] [Thread-1 (]: Began running node model.stock_project.stock_data
[0m21:57:55.098308 [info ] [Thread-1 (]: 1 of 3 START sql table model data.stock_data ................................... [RUN]
[0m21:57:55.098975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now model.stock_project.stock_data)
[0m21:57:55.099512 [debug] [Thread-1 (]: Began compiling node model.stock_project.stock_data
[0m21:57:55.108494 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_project.stock_data"
[0m21:57:55.115154 [debug] [Thread-1 (]: Began executing node model.stock_project.stock_data
[0m21:57:55.144411 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_project.stock_data"
[0m21:57:55.164793 [debug] [Thread-1 (]: Using snowflake connection "model.stock_project.stock_data"
[0m21:57:55.165214 [debug] [Thread-1 (]: On model.stock_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.stock_project.stock_data"} */
create or replace transient table stock.data.stock_data
         as
        (-- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
        );
[0m21:57:55.165567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:56.563090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.397 seconds
[0m21:57:56.597197 [debug] [Thread-1 (]: On model.stock_project.stock_data: Close
[0m21:57:56.698455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ace00>]}
[0m21:57:56.699388 [info ] [Thread-1 (]: 1 of 3 OK created sql table model data.stock_data .............................. [[32mSUCCESS 1[0m in 1.60s]
[0m21:57:56.700068 [debug] [Thread-1 (]: Finished running node model.stock_project.stock_data
[0m21:57:56.701037 [debug] [Thread-3 (]: Began running node model.stock_project.stock_analysis
[0m21:57:56.701630 [info ] [Thread-3 (]: 2 of 3 START sql table model data.stock_analysis ............................... [RUN]
[0m21:57:56.702211 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.stock_project.stock_analysis'
[0m21:57:56.702579 [debug] [Thread-3 (]: Began compiling node model.stock_project.stock_analysis
[0m21:57:56.705573 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_project.stock_analysis"
[0m21:57:56.712179 [debug] [Thread-3 (]: Began executing node model.stock_project.stock_analysis
[0m21:57:56.714733 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_project.stock_analysis"
[0m21:57:56.730115 [debug] [Thread-3 (]: Using snowflake connection "model.stock_project.stock_analysis"
[0m21:57:56.730727 [debug] [Thread-3 (]: On model.stock_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.stock_project.stock_analysis"} */
create or replace transient table stock.data.stock_analysis
         as
        (-- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
        );
[0m21:57:56.731140 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:57.998848 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m21:57:58.001666 [debug] [Thread-3 (]: On model.stock_project.stock_analysis: Close
[0m21:57:58.133223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d40b60>]}
[0m21:57:58.134770 [info ] [Thread-3 (]: 2 of 3 OK created sql table model data.stock_analysis .......................... [[32mSUCCESS 1[0m in 1.43s]
[0m21:57:58.135729 [debug] [Thread-3 (]: Finished running node model.stock_project.stock_analysis
[0m21:57:58.136745 [debug] [Thread-2 (]: Began running node model.stock_project.stock_mart
[0m21:57:58.138161 [info ] [Thread-2 (]: 3 of 3 START sql table model data.stock_mart ................................... [RUN]
[0m21:57:58.139099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_project.stock_mart)
[0m21:57:58.139644 [debug] [Thread-2 (]: Began compiling node model.stock_project.stock_mart
[0m21:57:58.143751 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_project.stock_mart"
[0m21:57:58.147589 [debug] [Thread-2 (]: Began executing node model.stock_project.stock_mart
[0m21:57:58.150706 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_project.stock_mart"
[0m21:57:58.164673 [debug] [Thread-2 (]: Using snowflake connection "model.stock_project.stock_mart"
[0m21:57:58.165338 [debug] [Thread-2 (]: On model.stock_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.stock_project.stock_mart"} */
create or replace transient table stock.data.stock_mart
         as
        (-- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
        );
[0m21:57:58.165863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:57:59.435841 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.269 seconds
[0m21:57:59.441132 [debug] [Thread-2 (]: On model.stock_project.stock_mart: Close
[0m21:57:59.564549 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f24ca3-0304-4a91-864f-d53e8686f883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d9fb60>]}
[0m21:57:59.567909 [info ] [Thread-2 (]: 3 of 3 OK created sql table model data.stock_mart .............................. [[32mSUCCESS 1[0m in 1.43s]
[0m21:57:59.569094 [debug] [Thread-2 (]: Finished running node model.stock_project.stock_mart
[0m21:57:59.571181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:59.571774 [debug] [MainThread]: Connection 'model.stock_project.stock_data' was properly closed.
[0m21:57:59.572249 [debug] [MainThread]: Connection 'model.stock_project.stock_mart' was properly closed.
[0m21:57:59.572965 [debug] [MainThread]: Connection 'model.stock_project.stock_analysis' was properly closed.
[0m21:57:59.573718 [info ] [MainThread]: 
[0m21:57:59.574577 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m21:57:59.576822 [debug] [MainThread]: Command end result
[0m21:57:59.693006 [info ] [MainThread]: 
[0m21:57:59.693686 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:59.694084 [info ] [MainThread]: 
[0m21:57:59.694489 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:57:59.701248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.692484, "process_user_time": 3.332033, "process_kernel_time": 1.470192, "process_mem_max_rss": "204341248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:59.701915 [debug] [MainThread]: Command `dbt run` succeeded at 21:57:59.701815 after 8.69 seconds
[0m21:57:59.702365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a37f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e13620>]}
[0m21:57:59.702766 [debug] [MainThread]: Flushing usage events
[0m00:55:05.806234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff936a1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937d30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff936a2ff0>]}


============================== 00:55:05.811832 | e381611e-15cc-4325-b457-b8afc75bbbd6 ==============================
[0m00:55:05.811832 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:55:05.812374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:06.383399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947b41d0>]}
[0m00:55:06.408371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b2f4a0>]}
[0m00:55:06.408882 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:55:06.459267 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:55:06.526347 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:55:06.526754 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:55:06.527175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81511dc0>]}
[0m00:55:07.107263 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:55:07.108179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8149fd70>]}
[0m00:55:07.271899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m00:55:07.278116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b5f4a0>]}
[0m00:55:07.423106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81834ef0>]}
[0m00:55:07.423514 [info ] [MainThread]: Found 3 models, 1 snapshot, 10 data tests, 1 source, 460 macros
[0m00:55:07.424019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b21970>]}
[0m00:55:07.425280 [info ] [MainThread]: 
[0m00:55:07.425899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:07.428579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m00:55:07.436315 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m00:55:07.436626 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m00:55:07.436866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:08.290427 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.853 seconds
[0m00:55:08.293901 [debug] [ThreadPool]: On list_stock: Close
[0m00:55:08.414334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m00:55:08.420952 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m00:55:08.421420 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m00:55:08.421732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:08.954119 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86077-0004-2cf5-0002-756f0001553a
[0m00:55:08.955378 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:55:08.956366 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:55:08.957040 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:55:08.957850 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m00:55:09.079446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m00:55:09.086930 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m00:55:09.087948 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m00:55:09.088764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:09.559007 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.470 seconds
[0m00:55:09.563266 [debug] [ThreadPool]: On list_stock_data: Close
[0m00:55:09.720390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e49850>]}
[0m00:55:09.722048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:09.723998 [info ] [MainThread]: 
[0m00:55:09.739858 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m00:55:09.740848 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m00:55:09.741906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m00:55:09.742604 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m00:55:09.750413 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m00:55:09.755624 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m00:55:09.777627 [debug] [Thread-1 (]: Dropping relation "STOCK"."DATA"."STOCK_DATA" because it is of type table
[0m00:55:09.782250 [debug] [Thread-1 (]: Applying DROP to: "STOCK"."DATA"."STOCK_DATA"
[0m00:55:09.786832 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m00:55:09.787210 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
drop table if exists "STOCK"."DATA"."STOCK_DATA" cascade
[0m00:55:09.787514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:10.343983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m00:55:10.363404 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m00:55:10.369202 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m00:55:10.369846 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m00:55:10.832687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m00:55:10.857849 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m00:55:10.981620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93feef90>]}
[0m00:55:10.982480 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 1.24s]
[0m00:55:10.983249 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m00:55:10.983866 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m00:55:10.984417 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m00:55:10.984833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m00:55:10.985161 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m00:55:10.987260 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m00:55:10.989533 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m00:55:10.991689 [debug] [Thread-1 (]: Dropping relation "STOCK"."DATA"."STOCK_ANALYSIS" because it is of type table
[0m00:55:10.994186 [debug] [Thread-1 (]: Applying DROP to: "STOCK"."DATA"."STOCK_ANALYSIS"
[0m00:55:10.996701 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m00:55:10.997063 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
drop table if exists "STOCK"."DATA"."STOCK_ANALYSIS" cascade
[0m00:55:10.997406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:11.455504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m00:55:11.462041 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m00:55:11.466959 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m00:55:11.467920 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m00:55:11.859396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m00:55:11.864892 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m00:55:11.978220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802cb890>]}
[0m00:55:11.980107 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.99s]
[0m00:55:11.982597 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m00:55:11.984107 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m00:55:11.985073 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m00:55:11.986290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m00:55:11.986977 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m00:55:11.991515 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m00:55:11.996158 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m00:55:11.999047 [debug] [Thread-1 (]: Dropping relation "STOCK"."DATA"."STOCK_MART" because it is of type table
[0m00:55:12.001689 [debug] [Thread-1 (]: Applying DROP to: "STOCK"."DATA"."STOCK_MART"
[0m00:55:12.002781 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m00:55:12.003324 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
drop table if exists "STOCK"."DATA"."STOCK_MART" cascade
[0m00:55:12.003842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:12.412614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m00:55:12.415457 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m00:55:12.420988 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m00:55:12.421755 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m00:55:12.844999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m00:55:12.848541 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m00:55:12.988006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e381611e-15cc-4325-b457-b8afc75bbbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8073bc20>]}
[0m00:55:12.990567 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 1.00s]
[0m00:55:12.992288 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m00:55:12.993399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:12.993793 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m00:55:12.994147 [info ] [MainThread]: 
[0m00:55:12.994923 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m00:55:12.995738 [debug] [MainThread]: Command end result
[0m00:55:13.079487 [info ] [MainThread]: 
[0m00:55:13.080152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:13.080617 [info ] [MainThread]: 
[0m00:55:13.081223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:55:13.082349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3136272, "process_user_time": 3.359956, "process_kernel_time": 0.351367, "process_mem_max_rss": "214588", "process_in_blocks": "13304", "process_out_blocks": "6625"}
[0m00:55:13.082733 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:13.082673 after 7.31 seconds
[0m00:55:13.082988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f6aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944a3800>]}
[0m00:55:13.083250 [debug] [MainThread]: Flushing usage events
[0m00:55:15.744473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8446f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8408d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854e9790>]}


============================== 00:55:15.748826 | 30400ea5-b5a4-49a3-8eca-c412708c6e4b ==============================
[0m00:55:15.748826 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:55:15.749243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:16.163173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30400ea5-b5a4-49a3-8eca-c412708c6e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73910ce0>]}
[0m00:55:16.187932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30400ea5-b5a4-49a3-8eca-c412708c6e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff722fe960>]}
[0m00:55:16.188549 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:55:16.237265 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:55:16.320248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:16.320541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:16.323188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.transformations
- models.dbt.marts
- snapshots.dbt
[0m00:55:16.348162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30400ea5-b5a4-49a3-8eca-c412708c6e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff714c1850>]}
[0m00:55:16.426178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30400ea5-b5a4-49a3-8eca-c412708c6e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70fa8ce0>]}
[0m00:55:16.426529 [info ] [MainThread]: Found 3 models, 1 snapshot, 10 data tests, 1 source, 460 macros
[0m00:55:16.426762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30400ea5-b5a4-49a3-8eca-c412708c6e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff714afa10>]}
[0m00:55:16.427997 [info ] [MainThread]: 
[0m00:55:16.428416 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:16.431039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m00:55:16.440495 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m00:55:16.440785 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m00:55:16.441018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:16.884213 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.443 seconds
[0m00:55:16.889547 [debug] [ThreadPool]: On list_stock_data: Close
[0m00:55:16.988717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m00:55:16.994954 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m00:55:16.995824 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m00:55:16.996570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:17.478877 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86077-0004-2ced-0000-0002756ff551
[0m00:55:17.479709 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:55:17.480389 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:55:17.480907 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:55:17.481449 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m00:55:17.611075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30400ea5-b5a4-49a3-8eca-c412708c6e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f8d340>]}
[0m00:55:17.612611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:17.613764 [info ] [MainThread]: 
[0m00:55:17.628842 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m00:55:17.629804 [info ] [Thread-1 (]: 1 of 10 START test not_null_stock_analysis_date ................................ [RUN]
[0m00:55:17.630979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m00:55:17.631669 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m00:55:17.649450 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m00:55:17.653525 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m00:55:17.670311 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m00:55:17.673566 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m00:55:17.673903 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m00:55:17.674198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:18.247755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m00:55:18.263687 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m00:55:18.367165 [info ] [Thread-1 (]: 1 of 10 PASS not_null_stock_analysis_date ...................................... [[32mPASS[0m in 0.74s]
[0m00:55:18.369202 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m00:55:18.370721 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m00:55:18.371997 [info ] [Thread-1 (]: 2 of 10 START test not_null_stock_analysis_symbol .............................. [RUN]
[0m00:55:18.373555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m00:55:18.374333 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m00:55:18.380772 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m00:55:18.384937 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m00:55:18.389544 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m00:55:18.392868 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m00:55:18.393807 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m00:55:18.394415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:19.040812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m00:55:19.046424 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m00:55:19.208316 [info ] [Thread-1 (]: 2 of 10 PASS not_null_stock_analysis_symbol .................................... [[32mPASS[0m in 0.83s]
[0m00:55:19.210150 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m00:55:19.211108 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m00:55:19.212545 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_data_date .................................... [RUN]
[0m00:55:19.213864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m00:55:19.214728 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m00:55:19.221529 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m00:55:19.226262 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m00:55:19.229630 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m00:55:19.233238 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m00:55:19.233904 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m00:55:19.234510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:20.155927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.921 seconds
[0m00:55:20.161614 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m00:55:20.271339 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_data_date .......................................... [[32mPASS[0m in 1.06s]
[0m00:55:20.274459 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m00:55:20.275496 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m00:55:20.276329 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_data_symbol .................................. [RUN]
[0m00:55:20.277604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m00:55:20.278418 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m00:55:20.285100 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m00:55:20.288717 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m00:55:20.291612 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m00:55:20.295461 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m00:55:20.296177 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m00:55:20.296924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:20.752352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m00:55:20.757014 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m00:55:20.855159 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_data_symbol ........................................ [[32mPASS[0m in 0.58s]
[0m00:55:20.856516 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m00:55:20.857332 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m00:55:20.858108 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_stock_data_source_market_dat_date ........... [RUN]
[0m00:55:20.859256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m00:55:20.859931 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m00:55:20.864328 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m00:55:20.866450 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m00:55:20.867722 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m00:55:20.869418 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m00:55:20.869680 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m00:55:20.869893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:21.588183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m00:55:21.594193 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m00:55:21.711784 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_stock_data_source_market_dat_date ................. [[32mPASS[0m in 0.85s]
[0m00:55:21.713075 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m00:55:21.713975 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m00:55:21.714811 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_stock_data_source_market_dat_symbol ......... [RUN]
[0m00:55:21.715788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m00:55:21.716427 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m00:55:21.723804 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m00:55:21.728298 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m00:55:21.734025 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m00:55:21.737856 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m00:55:21.738565 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m00:55:21.739309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:22.347768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m00:55:22.354023 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m00:55:22.480482 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_stock_data_source_market_dat_symbol ............... [[32mPASS[0m in 0.76s]
[0m00:55:22.482328 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m00:55:22.483258 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m00:55:22.484064 [info ] [Thread-1 (]: 7 of 10 START test source_unique_stock_data_source_market_dat_symbol ........... [RUN]
[0m00:55:22.485300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c)
[0m00:55:22.486033 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m00:55:22.494526 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"
[0m00:55:22.498614 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m00:55:22.501412 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"
[0m00:55:22.505029 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"
[0m00:55:22.505590 [debug] [Thread-1 (]: On test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from STOCK.data.market_dat
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m00:55:22.506089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:23.328003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m00:55:23.334005 [debug] [Thread-1 (]: On test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c: Close
[0m00:55:23.461594 [error] [Thread-1 (]: 7 of 10 FAIL 2 source_unique_stock_data_source_market_dat_symbol ............... [[31mFAIL 2[0m in 0.98s]
[0m00:55:23.462865 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m00:55:23.463754 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests
[0m00:55:23.464677 [info ] [Thread-1 (]: 8 of 10 START test stock_tests ................................................. [RUN]
[0m00:55:23.465603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c, now test.stock_analysis_project.stock_tests)
[0m00:55:23.466441 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests
[0m00:55:23.470937 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests"
[0m00:55:23.475755 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests
[0m00:55:23.478914 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests"
[0m00:55:23.482373 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests"
[0m00:55:23.482884 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/stock_tests.sql

-- Test to ensure there are no null values in the 'date' column
SELECT *
FROM stock.data.stock_data
WHERE date IS NULL

-- Test to ensure each date-symbol combination is unique
SELECT
    date,
    symbol,
    COUNT(*)
FROM stock.data.stock_data
GROUP BY date, symbol
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m00:55:23.483323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:23.867722 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86077-0004-2ceb-0002-756f00010532
[0m00:55:23.869821 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'SELECT'.
syntax error line 17 at position 9 unexpected '('.
syntax error line 22 at position 4 unexpected ')'.
[0m00:55:23.870913 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: Close
[0m00:55:23.983580 [debug] [Thread-1 (]: Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  syntax error line 17 at position 9 unexpected '('.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m00:55:23.984611 [error] [Thread-1 (]: 8 of 10 ERROR stock_tests ...................................................... [[31mERROR[0m in 0.52s]
[0m00:55:23.985758 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests
[0m00:55:23.986416 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536
[0m00:55:23.987588 [info ] [Thread-1 (]: 9 of 10 START test unique_stock_analysis_symbol ................................ [RUN]
[0m00:55:23.988274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.stock_tests, now test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536)
[0m00:55:23.988767 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536
[0m00:55:23.992688 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536"
[0m00:55:23.994909 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536
[0m00:55:23.997040 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536"
[0m00:55:23.999189 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536"
[0m00:55:23.999708 [debug] [Thread-1 (]: On test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from stock.data.stock_analysis
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m00:55:24.000152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:24.507593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m00:55:24.511522 [debug] [Thread-1 (]: On test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536: Close
[0m00:55:24.632001 [error] [Thread-1 (]: 9 of 10 FAIL 2 unique_stock_analysis_symbol .................................... [[31mFAIL 2[0m in 0.64s]
[0m00:55:24.635073 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536
[0m00:55:24.636181 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.unique_stock_data_symbol.97c341301f
[0m00:55:24.637030 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_data_symbol ................................... [RUN]
[0m00:55:24.638447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.unique_stock_analysis_symbol.9d914c2536, now test.stock_analysis_project.unique_stock_data_symbol.97c341301f)
[0m00:55:24.639202 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.unique_stock_data_symbol.97c341301f
[0m00:55:24.645679 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.unique_stock_data_symbol.97c341301f"
[0m00:55:24.649591 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.unique_stock_data_symbol.97c341301f
[0m00:55:24.654351 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.unique_stock_data_symbol.97c341301f"
[0m00:55:24.658060 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.unique_stock_data_symbol.97c341301f"
[0m00:55:24.658691 [debug] [Thread-1 (]: On test.stock_analysis_project.unique_stock_data_symbol.97c341301f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.unique_stock_data_symbol.97c341301f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from stock.data.stock_data
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m00:55:24.659519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:25.309199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m00:55:25.312343 [debug] [Thread-1 (]: On test.stock_analysis_project.unique_stock_data_symbol.97c341301f: Close
[0m00:55:25.445406 [error] [Thread-1 (]: 10 of 10 FAIL 2 unique_stock_data_symbol ....................................... [[31mFAIL 2[0m in 0.81s]
[0m00:55:25.448002 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.unique_stock_data_symbol.97c341301f
[0m00:55:25.450898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:25.451717 [debug] [MainThread]: Connection 'test.stock_analysis_project.unique_stock_data_symbol.97c341301f' was properly closed.
[0m00:55:25.452498 [info ] [MainThread]: 
[0m00:55:25.453100 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m00:55:25.456068 [debug] [MainThread]: Command end result
[0m00:55:25.591762 [info ] [MainThread]: 
[0m00:55:25.592818 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:55:25.593493 [info ] [MainThread]: 
[0m00:55:25.594187 [error] [MainThread]: [31mFailure in test source_unique_stock_data_source_market_dat_symbol (models/sources.yml)[0m
[0m00:55:25.594773 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m00:55:25.595236 [info ] [MainThread]: 
[0m00:55:25.595743 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/models/sources.yml/source_unique_stock_data_source_market_dat_symbol.sql
[0m00:55:25.596202 [info ] [MainThread]: 
[0m00:55:25.596720 [error] [MainThread]:   Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  syntax error line 17 at position 9 unexpected '('.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m00:55:25.597298 [info ] [MainThread]: 
[0m00:55:25.598057 [error] [MainThread]: [31mFailure in test unique_stock_analysis_symbol (models/schema.yml)[0m
[0m00:55:25.598745 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m00:55:25.599349 [info ] [MainThread]: 
[0m00:55:25.600036 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/models/schema.yml/unique_stock_analysis_symbol.sql
[0m00:55:25.600527 [info ] [MainThread]: 
[0m00:55:25.601035 [error] [MainThread]: [31mFailure in test unique_stock_data_symbol (models/schema.yml)[0m
[0m00:55:25.601538 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m00:55:25.601963 [info ] [MainThread]: 
[0m00:55:25.602517 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/models/schema.yml/unique_stock_data_symbol.sql
[0m00:55:25.603099 [info ] [MainThread]: 
[0m00:55:25.603681 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m00:55:25.604871 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.913618, "process_user_time": 2.792955, "process_kernel_time": 0.198854, "process_mem_max_rss": "209924", "process_out_blocks": "2021", "command_success": false, "process_in_blocks": "0"}
[0m00:55:25.605343 [debug] [MainThread]: Command `dbt test` failed at 00:55:25.605261 after 9.91 seconds
[0m00:55:25.605744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e21e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83cde090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83686000>]}
[0m00:55:25.606151 [debug] [MainThread]: Flushing usage events
[0m01:10:31.720520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80bd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80bc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ab5dc0>]}


============================== 01:10:31.726802 | 0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423 ==============================
[0m01:10:31.726802 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:10:31.727205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:32.214660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ae87d0>]}
[0m01:10:32.239776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f3e960>]}
[0m01:10:32.240281 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:10:32.290021 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:10:32.372037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:10:32.372593 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://models/schema.yml
[0m01:10:32.471640 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:10:32.472105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954107a0>]}
[0m01:10:32.607757 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.transformations
- models.dbt.marts
- models.dbt.raw
- snapshots.dbt
[0m01:10:32.616340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f52f60>]}
[0m01:10:32.687401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95715dc0>]}
[0m01:10:32.687768 [info ] [MainThread]: Found 3 models, 1 snapshot, 8 data tests, 1 source, 460 macros
[0m01:10:32.688374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95701490>]}
[0m01:10:32.689390 [info ] [MainThread]: 
[0m01:10:32.689855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:10:32.692250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m01:10:32.699841 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m01:10:32.700286 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m01:10:32.700537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:33.245381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.544 seconds
[0m01:10:33.249711 [debug] [ThreadPool]: On list_stock: Close
[0m01:10:33.386729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m01:10:33.402050 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:10:33.402773 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:10:33.403571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:33.894035 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86086-0004-2cef-0002-756f0001809e
[0m01:10:33.895029 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:10:33.895680 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:10:33.896149 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:10:33.896670 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:10:34.012263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m01:10:34.014924 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:10:34.015464 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:10:34.015887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:34.537741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.522 seconds
[0m01:10:34.541493 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:10:34.663460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95872270>]}
[0m01:10:34.664810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:34.666372 [info ] [MainThread]: 
[0m01:10:34.681862 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m01:10:34.682838 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m01:10:34.683982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m01:10:34.684706 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m01:10:34.692132 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m01:10:34.701780 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m01:10:34.728918 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m01:10:34.760591 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m01:10:34.761103 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m01:10:34.761521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:36.110434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.349 seconds
[0m01:10:36.143877 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m01:10:36.275207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f21eb0>]}
[0m01:10:36.277824 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 1.59s]
[0m01:10:36.279251 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m01:10:36.280794 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m01:10:36.281945 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m01:10:36.283085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m01:10:36.283852 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m01:10:36.288186 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m01:10:36.297591 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m01:10:36.301041 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m01:10:36.314260 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m01:10:36.314968 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m01:10:36.315575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:36.976096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m01:10:36.977539 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m01:10:37.625402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943dec30>]}
[0m01:10:37.627039 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 1.34s]
[0m01:10:37.628398 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m01:10:37.630374 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m01:10:37.630955 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m01:10:37.631549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m01:10:37.631795 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m01:10:37.633427 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m01:10:37.637530 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m01:10:37.638802 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m01:10:37.654829 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m01:10:37.655957 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m01:10:37.656292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:38.420066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m01:10:38.425292 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m01:10:38.547272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebd6c2f-3c20-4a48-92eb-00c2c5ad2423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94233f80>]}
[0m01:10:38.549034 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m01:10:38.551088 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m01:10:38.553176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:38.553695 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m01:10:38.554298 [info ] [MainThread]: 
[0m01:10:38.554798 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m01:10:38.556121 [debug] [MainThread]: Command end result
[0m01:10:38.705990 [info ] [MainThread]: 
[0m01:10:38.706852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:10:38.707359 [info ] [MainThread]: 
[0m01:10:38.707815 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:10:38.709022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0390353, "process_user_time": 2.600643, "process_kernel_time": 0.278927, "process_mem_max_rss": "212192", "process_out_blocks": "2879", "process_in_blocks": "0"}
[0m01:10:38.709532 [debug] [MainThread]: Command `dbt run` succeeded at 01:10:38.709423 after 7.04 seconds
[0m01:10:38.709926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7717f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8180bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b76720>]}
[0m01:10:38.710327 [debug] [MainThread]: Flushing usage events
[0m01:10:40.595368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd1deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0be6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1acbf0>]}


============================== 01:10:40.599587 | f91a81d7-59eb-4113-9bd1-6f3a6adb050b ==============================
[0m01:10:40.599587 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:10:40.600015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:41.003064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f91a81d7-59eb-4113-9bd1-6f3a6adb050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c394d70>]}
[0m01:10:41.027528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f91a81d7-59eb-4113-9bd1-6f3a6adb050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d59f5c0>]}
[0m01:10:41.028040 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:10:41.075867 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:10:41.160579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:41.160925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:41.163578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.marts
- models.dbt.transformations
- snapshots.dbt
[0m01:10:41.189152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f91a81d7-59eb-4113-9bd1-6f3a6adb050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c762a0>]}
[0m01:10:41.280288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f91a81d7-59eb-4113-9bd1-6f3a6adb050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97780a70>]}
[0m01:10:41.280732 [info ] [MainThread]: Found 3 models, 1 snapshot, 8 data tests, 1 source, 460 macros
[0m01:10:41.281061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f91a81d7-59eb-4113-9bd1-6f3a6adb050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c9e1b0>]}
[0m01:10:41.282569 [info ] [MainThread]: 
[0m01:10:41.283554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:10:41.286586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m01:10:41.295833 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:10:41.296326 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:10:41.296566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:41.802133 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.505 seconds
[0m01:10:41.807154 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:10:41.907437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m01:10:41.913839 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:10:41.914716 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:10:41.915415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:42.385657 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86086-0004-2cf3-0002-756f0001350e
[0m01:10:42.387022 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:10:42.388122 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:10:42.389336 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:10:42.390274 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:10:42.502230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f91a81d7-59eb-4113-9bd1-6f3a6adb050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97795340>]}
[0m01:10:42.503506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:42.504189 [info ] [MainThread]: 
[0m01:10:42.517758 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:10:42.518590 [info ] [Thread-1 (]: 1 of 8 START test not_null_stock_analysis_date ................................. [RUN]
[0m01:10:42.519607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m01:10:42.520164 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:10:42.536070 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:10:42.545219 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:10:42.561227 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:10:42.566251 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:10:42.566631 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m01:10:42.566979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:43.686505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m01:10:43.702792 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m01:10:43.834735 [info ] [Thread-1 (]: 1 of 8 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 1.31s]
[0m01:10:43.836607 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:10:43.837332 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:10:43.838341 [info ] [Thread-1 (]: 2 of 8 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m01:10:43.839954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m01:10:43.840761 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:10:43.847189 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:10:43.857984 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:10:43.861527 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:10:43.868026 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:10:43.868994 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m01:10:43.869978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:44.606163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m01:10:44.608920 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m01:10:44.715447 [info ] [Thread-1 (]: 2 of 8 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.87s]
[0m01:10:44.718616 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:10:44.719880 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:10:44.721026 [info ] [Thread-1 (]: 3 of 8 START test not_null_stock_data_date ..................................... [RUN]
[0m01:10:44.722328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m01:10:44.723062 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:10:44.729314 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:10:44.741386 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:10:44.747487 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:10:44.754798 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:10:44.755462 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m01:10:44.756064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:45.428206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m01:10:45.432654 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m01:10:45.537853 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.81s]
[0m01:10:45.539757 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:10:45.540674 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:10:45.541457 [info ] [Thread-1 (]: 4 of 8 START test not_null_stock_data_symbol ................................... [RUN]
[0m01:10:45.542617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m01:10:45.543354 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:10:45.549715 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:10:45.566846 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:10:45.570147 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:10:45.577514 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:10:45.578335 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m01:10:45.579299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:46.072737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m01:10:46.078186 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m01:10:46.185409 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.64s]
[0m01:10:46.187373 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:10:46.188544 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:10:46.189373 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m01:10:46.190603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m01:10:46.191378 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:10:46.198004 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:10:46.215178 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:10:46.218652 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:10:46.227777 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:10:46.228668 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m01:10:46.229372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:47.301609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.072 seconds
[0m01:10:47.306850 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m01:10:47.409603 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 1.22s]
[0m01:10:47.412218 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:10:47.413482 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:10:47.414616 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m01:10:47.416076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m01:10:47.416804 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:10:47.423195 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:10:47.441165 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:10:47.447654 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:10:47.456306 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:10:47.457331 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m01:10:47.458164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:47.979164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m01:10:47.983104 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m01:10:48.148182 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.73s]
[0m01:10:48.150434 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:10:48.151416 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m01:10:48.152332 [info ] [Thread-1 (]: 7 of 8 START test source_unique_stock_data_source_market_dat_symbol ............ [RUN]
[0m01:10:48.153659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c)
[0m01:10:48.154463 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m01:10:48.163867 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"
[0m01:10:48.179644 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m01:10:48.185352 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"
[0m01:10:48.193028 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"
[0m01:10:48.193666 [debug] [Thread-1 (]: On test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from STOCK.data.market_dat
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:10:48.194285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:48.634601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m01:10:48.637837 [debug] [Thread-1 (]: On test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c: Close
[0m01:10:48.785681 [error] [Thread-1 (]: 7 of 8 FAIL 2 source_unique_stock_data_source_market_dat_symbol ................ [[31mFAIL 2[0m in 0.63s]
[0m01:10:48.788489 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c
[0m01:10:48.789493 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests
[0m01:10:48.790310 [info ] [Thread-1 (]: 8 of 8 START test stock_tests .................................................. [RUN]
[0m01:10:48.791770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_unique_stock_data_source_market_dat_symbol.f727561f5c, now test.stock_analysis_project.stock_tests)
[0m01:10:48.792526 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests
[0m01:10:48.797498 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests"
[0m01:10:48.805932 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests
[0m01:10:48.809565 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests"
[0m01:10:48.817466 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests"
[0m01:10:48.818199 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/stock_tests.sql

-- Test to ensure there are no null values in the 'date' column
SELECT *
FROM stock.data.stock_data
WHERE date IS NULL

-- Test to ensure each date-symbol combination is unique
SELECT
    date,
    symbol,
    COUNT(*)
FROM stock.data.stock_data
GROUP BY date, symbol
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m01:10:48.818847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:49.353136 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86086-0004-2cf5-0002-756f0001554a
[0m01:10:49.354546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'SELECT'.
syntax error line 17 at position 9 unexpected '('.
syntax error line 22 at position 4 unexpected ')'.
[0m01:10:49.356371 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: Close
[0m01:10:49.472058 [debug] [Thread-1 (]: Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  syntax error line 17 at position 9 unexpected '('.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:10:49.472859 [error] [Thread-1 (]: 8 of 8 ERROR stock_tests ....................................................... [[31mERROR[0m in 0.68s]
[0m01:10:49.473984 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests
[0m01:10:49.475932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:49.476361 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests' was properly closed.
[0m01:10:49.476786 [info ] [MainThread]: 
[0m01:10:49.477426 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m01:10:49.479040 [debug] [MainThread]: Command end result
[0m01:10:49.589189 [info ] [MainThread]: 
[0m01:10:49.590000 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:10:49.590475 [info ] [MainThread]: 
[0m01:10:49.591033 [error] [MainThread]: [31mFailure in test source_unique_stock_data_source_market_dat_symbol (models/sources.yml)[0m
[0m01:10:49.591569 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m01:10:49.592160 [info ] [MainThread]: 
[0m01:10:49.592663 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/models/sources.yml/source_unique_stock_data_source_market_dat_symbol.sql
[0m01:10:49.593139 [info ] [MainThread]: 
[0m01:10:49.593624 [error] [MainThread]:   Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  syntax error line 17 at position 9 unexpected '('.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:10:49.594245 [info ] [MainThread]: 
[0m01:10:49.594769 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m01:10:49.595847 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.05341, "process_user_time": 2.739864, "process_kernel_time": 0.194629, "process_mem_max_rss": "209908", "process_out_blocks": "1983", "command_success": false, "process_in_blocks": "0"}
[0m01:10:49.596399 [debug] [MainThread]: Command `dbt test` failed at 01:10:49.596321 after 9.05 seconds
[0m01:10:49.596758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd1deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c9d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae555e50>]}
[0m01:10:49.597089 [debug] [MainThread]: Flushing usage events
[0m01:18:41.243079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888a6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4517c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f045c0>]}


============================== 01:18:41.247455 | 36587810-65d6-41a4-ab36-64a80d38466b ==============================
[0m01:18:41.247455 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:18:41.247846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:18:41.702390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dcbaa0>]}
[0m01:18:41.726669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff797fb4d0>]}
[0m01:18:41.727136 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:18:41.777411 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:18:41.860604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:41.861071 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://models/sources.yml
[0m01:18:41.903493 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:18:41.903886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7262e2a0>]}
[0m01:18:41.995958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m01:18:42.002090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7203bef0>]}
[0m01:18:42.064699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff724b5d60>]}
[0m01:18:42.065036 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m01:18:42.065493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff723fa600>]}
[0m01:18:42.066544 [info ] [MainThread]: 
[0m01:18:42.067249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:42.069833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m01:18:42.076485 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m01:18:42.076760 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m01:18:42.076989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:42.648694 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.571 seconds
[0m01:18:42.653474 [debug] [ThreadPool]: On list_stock: Close
[0m01:18:42.817197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_stock_data)
[0m01:18:42.826218 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:18:42.826808 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:18:42.827183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:43.355983 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.528 seconds
[0m01:18:43.360750 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:18:43.490183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m01:18:43.495111 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:18:43.496138 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:18:43.496739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:43.952260 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8608e-0004-2cee-0002-756f000164ee
[0m01:18:43.953552 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:18:43.954457 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:18:43.955186 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:18:43.955997 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:18:44.084678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f9ac90>]}
[0m01:18:44.086515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:44.088838 [info ] [MainThread]: 
[0m01:18:44.104628 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m01:18:44.105574 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m01:18:44.106902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now model.stock_analysis_project.stock_data)
[0m01:18:44.107617 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m01:18:44.115394 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m01:18:44.118116 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m01:18:44.144239 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m01:18:44.146450 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m01:18:44.146816 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m01:18:44.147166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:44.959132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m01:18:44.988931 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m01:18:45.107665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727e03e0>]}
[0m01:18:45.108766 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 1.00s]
[0m01:18:45.109794 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m01:18:45.110832 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m01:18:45.111563 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m01:18:45.112226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m01:18:45.112695 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m01:18:45.115604 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m01:18:45.117926 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m01:18:45.121348 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m01:18:45.124073 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m01:18:45.124624 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m01:18:45.125221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:45.983780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m01:18:45.987132 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m01:18:46.124528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff714abec0>]}
[0m01:18:46.126509 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 1.01s]
[0m01:18:46.128209 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m01:18:46.129755 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m01:18:46.130751 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m01:18:46.131607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m01:18:46.132342 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m01:18:46.136811 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m01:18:46.139557 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m01:18:46.142586 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m01:18:46.145571 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m01:18:46.146145 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m01:18:46.146619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:47.008067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m01:18:47.010771 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m01:18:47.118614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36587810-65d6-41a4-ab36-64a80d38466b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff714d1c10>]}
[0m01:18:47.119497 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.99s]
[0m01:18:47.120190 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m01:18:47.121557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:47.121976 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m01:18:47.122417 [info ] [MainThread]: 
[0m01:18:47.122783 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m01:18:47.135147 [debug] [MainThread]: Command end result
[0m01:18:47.220473 [info ] [MainThread]: 
[0m01:18:47.220881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:47.221369 [info ] [MainThread]: 
[0m01:18:47.221803 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:18:47.222665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.027292, "process_user_time": 2.440038, "process_kernel_time": 0.2529, "process_mem_max_rss": "210620", "process_out_blocks": "2866", "process_in_blocks": "0"}
[0m01:18:47.223043 [debug] [MainThread]: Command `dbt run` succeeded at 01:18:47.222978 after 6.03 seconds
[0m01:18:47.223323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88838950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8822ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff714ab0b0>]}
[0m01:18:47.223581 [debug] [MainThread]: Flushing usage events
[0m01:18:49.446954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939ae1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935e1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935e12b0>]}


============================== 01:18:49.451193 | f09fbd2b-dd4b-41d5-b815-55a58b71cc50 ==============================
[0m01:18:49.451193 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:18:49.452182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:18:49.856519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f09fbd2b-dd4b-41d5-b815-55a58b71cc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951038c0>]}
[0m01:18:49.882446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f09fbd2b-dd4b-41d5-b815-55a58b71cc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b13200>]}
[0m01:18:49.883421 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:18:49.933061 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:18:50.025970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:50.026312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:50.028991 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.transformations
- models.dbt.marts
- models.dbt.raw
- snapshots.dbt
[0m01:18:50.053904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f09fbd2b-dd4b-41d5-b815-55a58b71cc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935e1dc0>]}
[0m01:18:50.135621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f09fbd2b-dd4b-41d5-b815-55a58b71cc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c9ea20>]}
[0m01:18:50.136038 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m01:18:50.136511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09fbd2b-dd4b-41d5-b815-55a58b71cc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814fa450>]}
[0m01:18:50.137693 [info ] [MainThread]: 
[0m01:18:50.138214 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:50.140789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m01:18:50.150393 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:18:50.150719 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:18:50.150962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:50.528309 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.377 seconds
[0m01:18:50.532084 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:18:50.636830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m01:18:50.640502 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:18:50.640860 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:18:50.641134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:51.078855 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8608e-0004-2ce7-0002-756f000124ea
[0m01:18:51.080540 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:18:51.081801 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:18:51.082499 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:18:51.083241 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:18:51.181506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09fbd2b-dd4b-41d5-b815-55a58b71cc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cf1700>]}
[0m01:18:51.182843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:51.184135 [info ] [MainThread]: 
[0m01:18:51.191768 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:18:51.192232 [info ] [Thread-1 (]: 1 of 7 START test not_null_stock_analysis_date ................................. [RUN]
[0m01:18:51.192835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m01:18:51.193125 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:18:51.201932 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:18:51.204301 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:18:51.215019 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:18:51.216636 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:18:51.216971 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m01:18:51.217245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:51.837376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m01:18:51.847057 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m01:18:51.957991 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 0.76s]
[0m01:18:51.959759 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:18:51.960680 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:18:51.961423 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m01:18:51.961989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m01:18:51.962359 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:18:51.964733 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:18:51.966545 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:18:51.967745 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:18:51.968982 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:18:51.969264 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m01:18:51.969524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:52.637152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m01:18:52.641308 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m01:18:52.767188 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.80s]
[0m01:18:52.768296 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:18:52.768723 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:18:52.769123 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_data_date ..................................... [RUN]
[0m01:18:52.769722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m01:18:52.770435 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:18:52.774745 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:18:52.777825 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:18:52.781589 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:18:52.783488 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:18:52.784103 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m01:18:52.784815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:53.347693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m01:18:53.351800 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m01:18:53.475521 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.70s]
[0m01:18:53.476328 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:18:53.476717 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:18:53.477054 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_data_symbol ................................... [RUN]
[0m01:18:53.477518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m01:18:53.477766 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:18:53.480083 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:18:53.481102 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:18:53.482252 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:18:53.483305 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:18:53.483581 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m01:18:53.483797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:54.203517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m01:18:54.207578 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m01:18:54.329859 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.85s]
[0m01:18:54.331885 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:18:54.332895 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:18:54.333955 [info ] [Thread-1 (]: 5 of 7 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m01:18:54.335082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m01:18:54.335428 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:18:54.337847 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:18:54.339031 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:18:54.340209 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:18:54.341492 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:18:54.341804 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m01:18:54.342133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:54.817856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m01:18:54.819660 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m01:18:54.933888 [info ] [Thread-1 (]: 5 of 7 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.60s]
[0m01:18:54.934863 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:18:54.935338 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:18:54.935795 [info ] [Thread-1 (]: 6 of 7 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m01:18:54.936465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m01:18:54.936943 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:18:54.939882 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:18:54.941051 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:18:54.942574 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:18:54.943611 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:18:54.943910 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m01:18:54.944170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:55.347287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m01:18:55.350245 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m01:18:55.468124 [info ] [Thread-1 (]: 6 of 7 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.53s]
[0m01:18:55.470823 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:18:55.471377 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests
[0m01:18:55.471800 [info ] [Thread-1 (]: 7 of 7 START test stock_tests .................................................. [RUN]
[0m01:18:55.472363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.stock_tests)
[0m01:18:55.472677 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests
[0m01:18:55.474423 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests"
[0m01:18:55.475579 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests
[0m01:18:55.476957 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests"
[0m01:18:55.478289 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests"
[0m01:18:55.478594 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/stock_tests.sql

-- Test to ensure there are no null values in the 'date' column
SELECT *
FROM stock.data.stock_data
WHERE date IS NULL

-- Test to ensure each date-symbol combination is unique
SELECT
    date,
    symbol,
    COUNT(*)
FROM stock.data.stock_data
GROUP BY date, symbol
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m01:18:55.478868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:55.881818 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8608e-0004-2ce7-0002-756f000124ee
[0m01:18:55.883059 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'SELECT'.
syntax error line 17 at position 9 unexpected '('.
syntax error line 22 at position 4 unexpected ')'.
[0m01:18:55.884031 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: Close
[0m01:18:56.013408 [debug] [Thread-1 (]: Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  syntax error line 17 at position 9 unexpected '('.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:18:56.014446 [error] [Thread-1 (]: 7 of 7 ERROR stock_tests ....................................................... [[31mERROR[0m in 0.54s]
[0m01:18:56.015735 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests
[0m01:18:56.018148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:56.018652 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests' was properly closed.
[0m01:18:56.019187 [info ] [MainThread]: 
[0m01:18:56.019950 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m01:18:56.021755 [debug] [MainThread]: Command end result
[0m01:18:56.133078 [info ] [MainThread]: 
[0m01:18:56.134050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:18:56.134592 [info ] [MainThread]: 
[0m01:18:56.135144 [error] [MainThread]:   Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  syntax error line 17 at position 9 unexpected '('.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:18:56.135837 [info ] [MainThread]: 
[0m01:18:56.136355 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m01:18:56.137479 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.7453847, "process_user_time": 2.499391, "process_kernel_time": 0.16575, "process_mem_max_rss": "209672", "process_out_blocks": "1962", "command_success": false, "process_in_blocks": "0"}
[0m01:18:56.138073 [debug] [MainThread]: Command `dbt test` failed at 01:18:56.137984 after 6.75 seconds
[0m01:18:56.138508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9800aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82352150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c5e570>]}
[0m01:18:56.138958 [debug] [MainThread]: Flushing usage events
[0m01:36:14.725692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825db9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f79fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800f1370>]}


============================== 01:36:14.738662 | 9b3ae754-531a-47f4-99c5-d762a831000b ==============================
[0m01:36:14.738662 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:36:14.739549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:36:15.290294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dceb290>]}
[0m01:36:15.315262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80745c70>]}
[0m01:36:15.315800 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:36:15.365856 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:36:15.451791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:36:15.452238 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://tests/stock_tests.sql
[0m01:36:15.547100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.transformations
- models.dbt.marts
- snapshots.dbt
[0m01:36:15.553758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d671820>]}
[0m01:36:15.619881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d4485f0>]}
[0m01:36:15.620222 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m01:36:15.620672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d743680>]}
[0m01:36:15.621653 [info ] [MainThread]: 
[0m01:36:15.622159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:36:15.624705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m01:36:15.631964 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m01:36:15.632283 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m01:36:15.632513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:16.169205 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.537 seconds
[0m01:36:16.170578 [debug] [ThreadPool]: On list_stock: Close
[0m01:36:16.270843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m01:36:16.284181 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:36:16.285040 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:36:16.285791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:16.736427 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860a0-0004-2cf3-0002-756f0001352a
[0m01:36:16.737853 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:36:16.739357 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:36:16.740204 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:36:16.741103 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:36:16.862979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m01:36:16.867224 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:36:16.867960 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:36:16.868749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:17.309660 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.441 seconds
[0m01:36:17.313252 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:36:17.419848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80dc5040>]}
[0m01:36:17.420621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:17.421335 [info ] [MainThread]: 
[0m01:36:17.430713 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m01:36:17.431374 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m01:36:17.432091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m01:36:17.432496 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m01:36:17.437305 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m01:36:17.442124 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m01:36:17.460661 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m01:36:17.476038 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m01:36:17.476535 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m01:36:17.476921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:18.358133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.881 seconds
[0m01:36:18.392637 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m01:36:18.500023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d99c9b0>]}
[0m01:36:18.501324 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 1.07s]
[0m01:36:18.502741 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m01:36:18.503852 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m01:36:18.504704 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m01:36:18.505655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m01:36:18.506219 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m01:36:18.509020 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m01:36:18.520213 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m01:36:18.522889 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m01:36:18.534762 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m01:36:18.535321 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m01:36:18.535850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:19.276724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m01:36:19.279818 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m01:36:19.399875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c68ec90>]}
[0m01:36:19.402104 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.89s]
[0m01:36:19.404914 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m01:36:19.406774 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m01:36:19.407856 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m01:36:19.409143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m01:36:19.409867 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m01:36:19.416424 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m01:36:19.426588 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m01:36:19.430336 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m01:36:19.441985 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m01:36:19.442751 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m01:36:19.443493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:20.063891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m01:36:20.070314 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m01:36:20.176254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3ae754-531a-47f4-99c5-d762a831000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c64c650>]}
[0m01:36:20.178437 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.77s]
[0m01:36:20.180560 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m01:36:20.182977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:20.183808 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m01:36:20.184661 [info ] [MainThread]: 
[0m01:36:20.185685 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m01:36:20.187638 [debug] [MainThread]: Command end result
[0m01:36:20.343188 [info ] [MainThread]: 
[0m01:36:20.343562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:36:20.343783 [info ] [MainThread]: 
[0m01:36:20.343996 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:36:20.345151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.672116, "process_user_time": 2.50634, "process_kernel_time": 0.346877, "process_mem_max_rss": "208784", "process_out_blocks": "2868", "process_in_blocks": "0"}
[0m01:36:20.345700 [debug] [MainThread]: Command `dbt run` succeeded at 01:36:20.345615 after 5.67 seconds
[0m01:36:20.346022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f79fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7fa0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7fa150>]}
[0m01:36:20.346329 [debug] [MainThread]: Flushing usage events
[0m01:36:22.548774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81edb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ff5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8047c0e0>]}


============================== 01:36:22.553018 | cd3b732b-a4c6-4065-9234-447dcb7e97b5 ==============================
[0m01:36:22.553018 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:36:22.553697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:36:22.953499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd3b732b-a4c6-4065-9234-447dcb7e97b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a97f590>]}
[0m01:36:22.977394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd3b732b-a4c6-4065-9234-447dcb7e97b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1d0560>]}
[0m01:36:22.977969 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:36:23.024803 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:36:23.111091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:36:23.111431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:36:23.114061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.transformations
- models.dbt.marts
- snapshots.dbt
[0m01:36:23.138776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd3b732b-a4c6-4065-9234-447dcb7e97b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a807770>]}
[0m01:36:23.219610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd3b732b-a4c6-4065-9234-447dcb7e97b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a3c7ec0>]}
[0m01:36:23.220048 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m01:36:23.220575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3b732b-a4c6-4065-9234-447dcb7e97b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a671f40>]}
[0m01:36:23.221778 [info ] [MainThread]: 
[0m01:36:23.222303 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:36:23.224640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m01:36:23.233615 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:36:23.233940 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:36:23.234192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:23.733133 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.499 seconds
[0m01:36:23.738211 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:36:23.860678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m01:36:23.866650 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:36:23.867481 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:36:23.868186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:24.267770 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860a0-0004-2ced-0000-0002756ff57d
[0m01:36:24.269310 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:36:24.270391 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:36:24.271408 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:36:24.272193 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:36:24.403160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3b732b-a4c6-4065-9234-447dcb7e97b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a3c6d50>]}
[0m01:36:24.405364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:24.406979 [info ] [MainThread]: 
[0m01:36:24.422634 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:36:24.423463 [info ] [Thread-1 (]: 1 of 7 START test not_null_stock_analysis_date ................................. [RUN]
[0m01:36:24.424406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m01:36:24.425157 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:36:24.442691 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:36:24.456615 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:36:24.473611 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:36:24.480352 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:36:24.480861 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m01:36:24.481461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:25.422874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.941 seconds
[0m01:36:25.438492 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m01:36:25.572726 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 1.15s]
[0m01:36:25.574780 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:36:25.575711 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:36:25.576462 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m01:36:25.577511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m01:36:25.578258 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:36:25.583257 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:36:25.598681 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:36:25.600895 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:36:25.607366 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:36:25.607855 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m01:36:25.608295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:26.448532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.840 seconds
[0m01:36:26.453816 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m01:36:26.601652 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 1.02s]
[0m01:36:26.603936 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:36:26.604957 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:36:26.605863 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_data_date ..................................... [RUN]
[0m01:36:26.607063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m01:36:26.607926 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:36:26.614326 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:36:26.631490 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:36:26.637138 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:36:26.645130 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:36:26.645808 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m01:36:26.646433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:27.265406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m01:36:27.271136 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m01:36:27.377207 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.77s]
[0m01:36:27.378515 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:36:27.388365 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:36:27.388955 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_data_symbol ................................... [RUN]
[0m01:36:27.389729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m01:36:27.390147 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:36:27.395364 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:36:27.404732 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:36:27.406291 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:36:27.411891 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:36:27.412254 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m01:36:27.412639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:28.037167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m01:36:28.043256 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m01:36:28.154608 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.76s]
[0m01:36:28.157671 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:36:28.158871 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:36:28.159794 [info ] [Thread-1 (]: 5 of 7 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m01:36:28.161131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m01:36:28.161921 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:36:28.168706 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:36:28.186335 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:36:28.189993 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:36:28.199619 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:36:28.200519 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m01:36:28.201279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:28.639225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m01:36:28.643602 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m01:36:28.749884 [info ] [Thread-1 (]: 5 of 7 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.59s]
[0m01:36:28.752519 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:36:28.753625 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:36:28.754479 [info ] [Thread-1 (]: 6 of 7 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m01:36:28.755720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m01:36:28.756519 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:36:28.762893 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:36:28.777921 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:36:28.781544 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:36:28.791896 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:36:28.792828 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m01:36:28.793656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:29.286648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m01:36:29.292296 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m01:36:29.400847 [info ] [Thread-1 (]: 6 of 7 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.64s]
[0m01:36:29.402985 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:36:29.403900 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests
[0m01:36:29.404741 [info ] [Thread-1 (]: 7 of 7 START test stock_tests .................................................. [RUN]
[0m01:36:29.405711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.stock_tests)
[0m01:36:29.406559 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests
[0m01:36:29.411482 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests"
[0m01:36:29.418897 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests
[0m01:36:29.422207 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests"
[0m01:36:29.432321 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests"
[0m01:36:29.433033 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/stock_tests.sql

-- Test to ensure there are no null values in the 'date' column
WITH invalid_date AS (
    SELECT *
    FROM stock.data.stock_data
    WHERE date IS NULL
)
SELECT COUNT(*) = 0 AS test_passed
FROM invalid_date;
[0m01:36:29.433691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:29.898863 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860a0-0004-2cef-0002-756f000180ca
[0m01:36:29.900242 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 17 unexpected ';'.
[0m01:36:29.901365 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: Close
[0m01:36:30.018677 [debug] [Thread-1 (]: Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 17 unexpected ';'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:36:30.019993 [error] [Thread-1 (]: 7 of 7 ERROR stock_tests ....................................................... [[31mERROR[0m in 0.61s]
[0m01:36:30.021683 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests
[0m01:36:30.024766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:30.025545 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests' was properly closed.
[0m01:36:30.026278 [info ] [MainThread]: 
[0m01:36:30.027250 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m01:36:30.029309 [debug] [MainThread]: Command end result
[0m01:36:30.161270 [info ] [MainThread]: 
[0m01:36:30.162283 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:36:30.163006 [info ] [MainThread]: 
[0m01:36:30.163710 [error] [MainThread]:   Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 17 unexpected ';'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:36:30.164180 [info ] [MainThread]: 
[0m01:36:30.164670 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m01:36:30.165685 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.6697264, "process_user_time": 2.554257, "process_kernel_time": 0.193019, "process_mem_max_rss": "209676", "process_out_blocks": "1964", "command_success": false, "process_in_blocks": "0"}
[0m01:36:30.166279 [debug] [MainThread]: Command `dbt test` failed at 01:36:30.166170 after 7.67 seconds
[0m01:36:30.166769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f16ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81edb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80afaf00>]}
[0m01:36:30.167216 [debug] [MainThread]: Flushing usage events
[0m01:54:54.470289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4dfa090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa563de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7be51f0>]}


============================== 01:54:54.475957 | 33100898-2c55-4ab3-b02d-8a22ed91653a ==============================
[0m01:54:54.475957 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:54:54.476442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:54:55.183284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950f8ce0>]}
[0m01:54:55.219596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b41e50>]}
[0m01:54:55.220385 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:54:55.278507 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:54:55.366834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:54:55.367384 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://tests/stock_tests.sql
[0m01:54:55.455310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.transformations
- models.dbt.raw
- models.dbt.marts
- snapshots.dbt
[0m01:54:55.462169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e857410>]}
[0m01:54:55.534527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea3a4b0>]}
[0m01:54:55.535021 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m01:54:55.535538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e95b680>]}
[0m01:54:55.536826 [info ] [MainThread]: 
[0m01:54:55.537382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:54:55.540043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m01:54:55.547882 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m01:54:55.548259 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m01:54:55.548515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:56.023416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.475 seconds
[0m01:54:56.026681 [debug] [ThreadPool]: On list_stock: Close
[0m01:54:56.133159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m01:54:56.138482 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:54:56.138855 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:54:56.139105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:56.594242 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860b2-0004-2cf4-0002-756f0001905e
[0m01:54:56.595227 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:54:56.596324 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:54:56.597994 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:54:56.599043 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:54:56.712240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m01:54:56.717439 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:54:56.718463 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:54:56.719229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:57.197640 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.478 seconds
[0m01:54:57.201546 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:54:57.311919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e99e990>]}
[0m01:54:57.314234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:57.316950 [info ] [MainThread]: 
[0m01:54:57.334510 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m01:54:57.335674 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m01:54:57.336889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m01:54:57.337539 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m01:54:57.345331 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m01:54:57.348360 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m01:54:57.374866 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m01:54:57.377084 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m01:54:57.377504 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m01:54:57.377908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:58.037024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m01:54:58.064104 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m01:54:58.171371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef8ca40>]}
[0m01:54:58.172964 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 0.83s]
[0m01:54:58.174727 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m01:54:58.176227 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m01:54:58.177530 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m01:54:58.178774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m01:54:58.179539 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m01:54:58.183050 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m01:54:58.186060 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m01:54:58.189463 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m01:54:58.193088 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m01:54:58.195292 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m01:54:58.196224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:58.981099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m01:54:58.986689 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m01:54:59.100709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc0e420>]}
[0m01:54:59.102909 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.92s]
[0m01:54:59.104843 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m01:54:59.106507 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m01:54:59.107462 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m01:54:59.108694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m01:54:59.109599 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m01:54:59.116139 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m01:54:59.119720 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m01:54:59.122894 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m01:54:59.126217 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m01:54:59.126936 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m01:54:59.127595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:59.897470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m01:54:59.900422 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m01:55:00.019565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33100898-2c55-4ab3-b02d-8a22ed91653a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc637d0>]}
[0m01:55:00.021112 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m01:55:00.022909 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m01:55:00.025224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:00.025986 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m01:55:00.026772 [info ] [MainThread]: 
[0m01:55:00.027919 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m01:55:00.029711 [debug] [MainThread]: Command end result
[0m01:55:00.136166 [info ] [MainThread]: 
[0m01:55:00.137273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:55:00.137948 [info ] [MainThread]: 
[0m01:55:00.138526 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:55:00.139969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.733182, "process_user_time": 2.695131, "process_kernel_time": 0.40517, "process_mem_max_rss": "208788", "process_out_blocks": "2868", "process_in_blocks": "0"}
[0m01:55:00.140666 [debug] [MainThread]: Command `dbt run` succeeded at 01:55:00.140555 after 5.73 seconds
[0m01:55:00.141318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d72360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a281a0>]}
[0m01:55:00.141929 [debug] [MainThread]: Flushing usage events
[0m01:55:02.161871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3ede20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9fa7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e938a40>]}


============================== 01:55:02.165926 | 129d6748-ce7c-4f13-9216-240470cdce95 ==============================
[0m01:55:02.165926 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:55:02.166578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:55:02.577526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129d6748-ce7c-4f13-9216-240470cdce95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1a7c80>]}
[0m01:55:02.602436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129d6748-ce7c-4f13-9216-240470cdce95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dec3dd0>]}
[0m01:55:02.603160 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:55:02.652276 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:55:02.742995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:55:02.743344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:55:02.746039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.marts
- models.dbt.transformations
- snapshots.dbt
[0m01:55:02.771000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129d6748-ce7c-4f13-9216-240470cdce95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77859580>]}
[0m01:55:02.850878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129d6748-ce7c-4f13-9216-240470cdce95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7733c8f0>]}
[0m01:55:02.851275 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m01:55:02.851734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129d6748-ce7c-4f13-9216-240470cdce95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7785a030>]}
[0m01:55:02.853011 [info ] [MainThread]: 
[0m01:55:02.853528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:55:02.856072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_snapshots'
[0m01:55:02.865107 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m01:55:02.865424 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m01:55:02.865686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:03.298772 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860b3-0004-2cec-0002-756f00017516
[0m01:55:03.300332 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:55:03.301515 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:55:03.302274 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:55:03.303148 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m01:55:03.420909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m01:55:03.426744 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m01:55:03.427612 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m01:55:03.428350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:55:03.941452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.513 seconds
[0m01:55:03.944043 [debug] [ThreadPool]: On list_stock_data: Close
[0m01:55:04.043012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129d6748-ce7c-4f13-9216-240470cdce95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77924980>]}
[0m01:55:04.044206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:55:04.045358 [info ] [MainThread]: 
[0m01:55:04.057521 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:55:04.058303 [info ] [Thread-1 (]: 1 of 7 START test not_null_stock_analysis_date ................................. [RUN]
[0m01:55:04.059318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m01:55:04.059834 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:55:04.074590 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:55:04.076434 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:55:04.090214 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:55:04.092157 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m01:55:04.092499 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m01:55:04.092772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:04.870178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m01:55:04.886854 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m01:55:05.032644 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 0.97s]
[0m01:55:05.034128 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m01:55:05.034768 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:55:05.035431 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m01:55:05.036260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m01:55:05.036839 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:55:05.041635 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:55:05.044982 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:55:05.047456 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:55:05.050005 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m01:55:05.050525 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m01:55:05.051036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:05.697059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m01:55:05.703192 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m01:55:05.809613 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.77s]
[0m01:55:05.811027 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m01:55:05.811598 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:55:05.812132 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_data_date ..................................... [RUN]
[0m01:55:05.812857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m01:55:05.813307 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:55:05.818448 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:55:05.820339 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:55:05.822163 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:55:05.823853 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m01:55:05.824208 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m01:55:05.824616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:06.436506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m01:55:06.440865 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m01:55:06.583210 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.77s]
[0m01:55:06.585166 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m01:55:06.586117 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:55:06.587480 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_data_symbol ................................... [RUN]
[0m01:55:06.589587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m01:55:06.590598 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:55:06.597375 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:55:06.600585 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:55:06.603579 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:55:06.606483 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m01:55:06.607194 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m01:55:06.608283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:07.332213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m01:55:07.335378 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m01:55:07.448886 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.86s]
[0m01:55:07.452825 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m01:55:07.453946 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:55:07.454905 [info ] [Thread-1 (]: 5 of 7 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m01:55:07.456178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m01:55:07.456979 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:55:07.464271 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:55:07.467593 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:55:07.470599 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:55:07.473885 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m01:55:07.474622 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m01:55:07.475293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:07.930073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m01:55:07.935963 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m01:55:08.033172 [info ] [Thread-1 (]: 5 of 7 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.58s]
[0m01:55:08.035146 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m01:55:08.036170 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:55:08.037656 [info ] [Thread-1 (]: 6 of 7 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m01:55:08.039794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m01:55:08.040935 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:55:08.048489 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:55:08.051621 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:55:08.054521 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:55:08.057798 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m01:55:08.058364 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m01:55:08.058902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:08.522225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m01:55:08.525819 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m01:55:08.644540 [info ] [Thread-1 (]: 6 of 7 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.60s]
[0m01:55:08.646868 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m01:55:08.647866 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests
[0m01:55:08.648766 [info ] [Thread-1 (]: 7 of 7 START test stock_tests .................................................. [RUN]
[0m01:55:08.650132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.stock_tests)
[0m01:55:08.651060 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests
[0m01:55:08.656298 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests"
[0m01:55:08.659720 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests
[0m01:55:08.665084 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests"
[0m01:55:08.668640 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests"
[0m01:55:08.669402 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/stock_tests.sql

-- Test to ensure there are no null values in the 'date' column
WITH invalid_date AS (
    SELECT *
    FROM stock.data.stock_data
    WHERE date IS NULL
)
SELECT COUNT(*) = 0 AS test_passed
FROM invalid_date

-- Test to ensure each date-symbol combination is unique
WITH duplicate_check AS (
    SELECT
        date,
        symbol,
        COUNT(*) AS record_count
    FROM stock.data.stock_data
    GROUP BY date, symbol
    HAVING COUNT(*) > 1
)
SELECT COUNT(*) = 0 AS test_passed
FROM duplicate_check
      
    ) dbt_internal_test
[0m01:55:08.670060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:09.040887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860b3-0004-2cef-0002-756f000180ce
[0m01:55:09.041549 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 0 unexpected 'WITH'.
syntax error line 22 at position 13 unexpected '('.
syntax error line 26 at position 0 unexpected ')'.
[0m01:55:09.042745 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests: Close
[0m01:55:09.160520 [debug] [Thread-1 (]: Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'WITH'.
  syntax error line 22 at position 13 unexpected '('.
  syntax error line 26 at position 0 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:55:09.161045 [error] [Thread-1 (]: 7 of 7 ERROR stock_tests ....................................................... [[31mERROR[0m in 0.51s]
[0m01:55:09.161826 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests
[0m01:55:09.163219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:09.163543 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests' was properly closed.
[0m01:55:09.163852 [info ] [MainThread]: 
[0m01:55:09.164282 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m01:55:09.165312 [debug] [MainThread]: Command end result
[0m01:55:09.298256 [info ] [MainThread]: 
[0m01:55:09.299052 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:55:09.299597 [info ] [MainThread]: 
[0m01:55:09.300142 [error] [MainThread]:   Database Error in test stock_tests (tests/stock_tests.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'WITH'.
  syntax error line 22 at position 13 unexpected '('.
  syntax error line 26 at position 0 unexpected ')'.
  compiled code at target/run/stock_analysis_project/tests/stock_tests.sql
[0m01:55:09.300589 [info ] [MainThread]: 
[0m01:55:09.300991 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m01:55:09.301955 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.1911774, "process_user_time": 2.485464, "process_kernel_time": 0.198116, "process_mem_max_rss": "209684", "process_out_blocks": "1965", "command_success": false, "process_in_blocks": "0"}
[0m01:55:09.302571 [debug] [MainThread]: Command `dbt test` failed at 01:55:09.302469 after 7.19 seconds
[0m01:55:09.303017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5e9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9fa7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcfa600>]}
[0m01:55:09.303426 [debug] [MainThread]: Flushing usage events
[0m02:30:40.533304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eaa5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fb1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eaa70e0>]}


============================== 02:30:40.538067 | 2bd953c2-1e3f-4134-a6d3-27cae913e524 ==============================
[0m02:30:40.538067 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:30:40.538512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:30:40.990512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4e6cf0>]}
[0m02:30:41.015520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cefe150>]}
[0m02:30:41.016031 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:30:41.064347 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:30:41.153749 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m02:30:41.154292 [debug] [MainThread]: Partial parsing: added file: stock_analysis_project://tests/stock_tests_1.sql
[0m02:30:41.154541 [debug] [MainThread]: Partial parsing: added file: stock_analysis_project://tests/stock_tests_2.sql
[0m02:30:41.154866 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://models/schema.yml
[0m02:30:41.155061 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis_project://tests/stock_tests.sql
[0m02:30:41.311957 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:30:41.312411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b10080>]}
[0m02:30:41.381758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m02:30:41.388781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77dd9be0>]}
[0m02:30:41.458489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777442c0>]}
[0m02:30:41.458996 [info ] [MainThread]: Found 3 models, 1 snapshot, 9 data tests, 1 source, 460 macros
[0m02:30:41.459668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77e0a690>]}
[0m02:30:41.460707 [info ] [MainThread]: 
[0m02:30:41.461232 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:30:41.463541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m02:30:41.470395 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m02:30:41.470730 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m02:30:41.470991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:42.044408 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.573 seconds
[0m02:30:42.048327 [debug] [ThreadPool]: On list_stock: Close
[0m02:30:42.165010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m02:30:42.174924 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m02:30:42.175517 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m02:30:42.176013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:42.738568 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860d6-0004-2cf4-0002-756f00019066
[0m02:30:42.739948 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:30:42.741596 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:30:42.742663 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:30:42.743582 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m02:30:42.953835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m02:30:42.958547 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m02:30:42.959393 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m02:30:42.960167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:43.443322 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.483 seconds
[0m02:30:43.448763 [debug] [ThreadPool]: On list_stock_data: Close
[0m02:30:43.647500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b4df40>]}
[0m02:30:43.648882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:43.650405 [info ] [MainThread]: 
[0m02:30:43.665339 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m02:30:43.666507 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m02:30:43.667635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m02:30:43.668339 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m02:30:43.676044 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m02:30:43.687559 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m02:30:43.713300 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m02:30:43.732540 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m02:30:43.732995 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m02:30:43.733354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:44.411019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m02:30:44.444260 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m02:30:44.584942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e909e50>]}
[0m02:30:44.586685 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m02:30:44.587917 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m02:30:44.589536 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m02:30:44.590383 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m02:30:44.591325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m02:30:44.592046 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m02:30:44.596285 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m02:30:44.605574 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m02:30:44.609061 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m02:30:44.621905 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m02:30:44.622639 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m02:30:44.623236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:45.320321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m02:30:45.326134 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m02:30:45.437622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7731ed20>]}
[0m02:30:45.439171 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.85s]
[0m02:30:45.440533 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m02:30:45.442098 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m02:30:45.443028 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m02:30:45.444182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m02:30:45.444754 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m02:30:45.448801 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m02:30:45.459865 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m02:30:45.462974 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m02:30:45.477276 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m02:30:45.477998 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m02:30:45.478529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:46.263300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m02:30:46.266928 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m02:30:46.384248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bd953c2-1e3f-4134-a6d3-27cae913e524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765d1fd0>]}
[0m02:30:46.385872 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.94s]
[0m02:30:46.387616 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m02:30:46.388831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:46.389205 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m02:30:46.389526 [info ] [MainThread]: 
[0m02:30:46.389819 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m02:30:46.390691 [debug] [MainThread]: Command end result
[0m02:30:46.535031 [info ] [MainThread]: 
[0m02:30:46.535950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:46.536611 [info ] [MainThread]: 
[0m02:30:46.537112 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:30:46.538392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0743995, "process_user_time": 2.856726, "process_kernel_time": 0.302182, "process_mem_max_rss": "213300", "process_out_blocks": "2891", "process_in_blocks": "0"}
[0m02:30:46.539609 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:46.539288 after 6.08 seconds
[0m02:30:46.540146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9280aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdc0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7770ce30>]}
[0m02:30:46.540997 [debug] [MainThread]: Flushing usage events
[0m02:30:49.260842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3abaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0f3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09ad1c0>]}


============================== 02:30:49.265158 | 551f18dc-ef79-47a8-bd79-613ea0d3d0c2 ==============================
[0m02:30:49.265158 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:30:49.265784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:30:49.691963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551f18dc-ef79-47a8-bd79-613ea0d3d0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb07c80>]}
[0m02:30:49.717121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551f18dc-ef79-47a8-bd79-613ea0d3d0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c86c6b0>]}
[0m02:30:49.717798 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:30:49.767002 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:30:49.863541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:49.864015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:49.867216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m02:30:49.894721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551f18dc-ef79-47a8-bd79-613ea0d3d0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3927b0>]}
[0m02:30:49.976732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551f18dc-ef79-47a8-bd79-613ea0d3d0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c4d3d0>]}
[0m02:30:49.977168 [info ] [MainThread]: Found 3 models, 1 snapshot, 9 data tests, 1 source, 460 macros
[0m02:30:49.977677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551f18dc-ef79-47a8-bd79-613ea0d3d0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87effd10>]}
[0m02:30:49.979024 [info ] [MainThread]: 
[0m02:30:49.979630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:30:49.982235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m02:30:49.992059 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m02:30:49.992466 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m02:30:49.992720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:50.526559 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.534 seconds
[0m02:30:50.529924 [debug] [ThreadPool]: On list_stock_data: Close
[0m02:30:50.628781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m02:30:50.633669 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m02:30:50.634185 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m02:30:50.634454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:51.106653 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860d6-0004-2ce7-0002-756f0001250a
[0m02:30:51.107660 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:30:51.108367 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:30:51.108687 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:30:51.109000 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m02:30:51.242151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551f18dc-ef79-47a8-bd79-613ea0d3d0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c4cfe0>]}
[0m02:30:51.242758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:51.243308 [info ] [MainThread]: 
[0m02:30:51.248792 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:30:51.249099 [info ] [Thread-1 (]: 1 of 9 START test not_null_stock_analysis_date ................................. [RUN]
[0m02:30:51.249556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m02:30:51.250001 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:30:51.259830 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m02:30:51.269973 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:30:51.280589 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m02:30:51.287154 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m02:30:51.287528 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m02:30:51.287823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:52.083317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m02:30:52.099425 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m02:30:52.245512 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 1.00s]
[0m02:30:52.246755 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:30:52.247406 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:30:52.248065 [info ] [Thread-1 (]: 2 of 9 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m02:30:52.248981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m02:30:52.249546 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:30:52.254007 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m02:30:52.266769 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:30:52.269198 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m02:30:52.275911 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m02:30:52.276506 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m02:30:52.277106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:53.013953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m02:30:53.018642 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m02:30:53.149694 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.90s]
[0m02:30:53.151626 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:30:53.152586 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:30:53.153516 [info ] [Thread-1 (]: 3 of 9 START test not_null_stock_data_date ..................................... [RUN]
[0m02:30:53.154751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m02:30:53.155756 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:30:53.163676 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m02:30:53.181042 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:30:53.184121 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m02:30:53.193696 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m02:30:53.194412 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m02:30:53.195138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:53.935564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m02:30:53.941433 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m02:30:54.096599 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.94s]
[0m02:30:54.099607 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:30:54.100956 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:30:54.101982 [info ] [Thread-1 (]: 4 of 9 START test not_null_stock_data_open ..................................... [RUN]
[0m02:30:54.103215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_open.757f574b25)
[0m02:30:54.104137 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:30:54.111304 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m02:30:54.115827 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:30:54.118800 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m02:30:54.122579 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m02:30:54.123263 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_open.757f574b25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from stock.data.stock_data
where open is null



      
    ) dbt_internal_test
[0m02:30:54.123951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:54.569867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m02:30:54.577243 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: Close
[0m02:30:54.696179 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stock_data_open ........................................... [[32mPASS[0m in 0.59s]
[0m02:30:54.698647 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:30:54.699626 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:30:54.700554 [info ] [Thread-1 (]: 5 of 9 START test not_null_stock_data_symbol ................................... [RUN]
[0m02:30:54.701721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_open.757f574b25, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m02:30:54.702550 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:30:54.709126 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m02:30:54.724946 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:30:54.728642 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m02:30:54.738128 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m02:30:54.739041 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m02:30:54.739978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:55.170874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m02:30:55.177844 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m02:30:55.294648 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.59s]
[0m02:30:55.296786 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:30:55.298046 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:30:55.299018 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m02:30:55.300284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m02:30:55.301127 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:30:55.308072 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m02:30:55.322212 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:30:55.325130 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m02:30:55.330628 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m02:30:55.331248 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m02:30:55.331813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:55.700082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m02:30:55.705785 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m02:30:55.824501 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.52s]
[0m02:30:55.827250 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:30:55.828286 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:30:55.829153 [info ] [Thread-1 (]: 7 of 9 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m02:30:55.830360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m02:30:55.831185 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:30:55.840229 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m02:30:55.857349 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:30:55.860893 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m02:30:55.869776 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m02:30:55.870694 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m02:30:55.871386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:56.341738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m02:30:56.346677 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m02:30:56.442223 [info ] [Thread-1 (]: 7 of 9 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.61s]
[0m02:30:56.444028 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:30:56.444991 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests_1
[0m02:30:56.445863 [info ] [Thread-1 (]: 8 of 9 START test stock_tests_1 ................................................ [RUN]
[0m02:30:56.447043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.stock_tests_1)
[0m02:30:56.447843 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests_1
[0m02:30:56.452352 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests_1"
[0m02:30:56.457228 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests_1
[0m02:30:56.460408 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests_1"
[0m02:30:56.464885 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests_1"
[0m02:30:56.465546 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests_1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/stock_tests.sql

-- Test to ensure there are no null values in the 'date' column
WITH invalid_date AS (
    SELECT *
    FROM stock.data.stock_data
    WHERE date IS NULL
)
SELECT COUNT(*) = 0 AS test_passed
FROM invalid_date
      
    ) dbt_internal_test
[0m02:30:56.466122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:57.212956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m02:30:57.217747 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_1: Close
[0m02:30:57.329075 [error] [Thread-1 (]: 8 of 9 FAIL 1 stock_tests_1 .................................................... [[31mFAIL 1[0m in 0.88s]
[0m02:30:57.330364 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests_1
[0m02:30:57.331375 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests_2
[0m02:30:57.332368 [info ] [Thread-1 (]: 9 of 9 START test stock_tests_2 ................................................ [RUN]
[0m02:30:57.333648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.stock_tests_1, now test.stock_analysis_project.stock_tests_2)
[0m02:30:57.334612 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests_2
[0m02:30:57.339033 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests_2"
[0m02:30:57.343752 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests_2
[0m02:30:57.346903 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests_2"
[0m02:30:57.351218 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests_2"
[0m02:30:57.351967 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests_2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test to ensure each date-symbol combination is unique
WITH duplicate_check AS (
    SELECT
        date,
        symbol,
        COUNT(*) AS record_count
    FROM stock.data.stock_data
    GROUP BY date, symbol
    HAVING COUNT(*) > 1
)
SELECT COUNT(*) = 0 AS test_passed
FROM duplicate_check
      
    ) dbt_internal_test
[0m02:30:57.352633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:58.128659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m02:30:58.131868 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_2: Close
[0m02:30:58.235855 [error] [Thread-1 (]: 9 of 9 FAIL 1 stock_tests_2 .................................................... [[31mFAIL 1[0m in 0.90s]
[0m02:30:58.238675 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests_2
[0m02:30:58.241477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:58.242248 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests_2' was properly closed.
[0m02:30:58.243068 [info ] [MainThread]: 
[0m02:30:58.244102 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m02:30:58.247189 [debug] [MainThread]: Command end result
[0m02:30:58.378919 [info ] [MainThread]: 
[0m02:30:58.379904 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:30:58.380547 [info ] [MainThread]: 
[0m02:30:58.381250 [error] [MainThread]: [31mFailure in test stock_tests_1 (tests/stock_tests_1.sql)[0m
[0m02:30:58.381924 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:30:58.382475 [info ] [MainThread]: 
[0m02:30:58.383068 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/tests/stock_tests_1.sql
[0m02:30:58.383575 [info ] [MainThread]: 
[0m02:30:58.384089 [error] [MainThread]: [31mFailure in test stock_tests_2 (tests/stock_tests_2.sql)[0m
[0m02:30:58.384528 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:30:58.384968 [info ] [MainThread]: 
[0m02:30:58.385463 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/tests/stock_tests_2.sql
[0m02:30:58.385918 [info ] [MainThread]: 
[0m02:30:58.386355 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m02:30:58.387432 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.190619, "process_user_time": 2.83484, "process_kernel_time": 0.211734, "process_mem_max_rss": "209424", "process_out_blocks": "1995", "command_success": false, "process_in_blocks": "0"}
[0m02:30:58.388023 [debug] [MainThread]: Command `dbt test` failed at 02:30:58.387934 after 9.19 seconds
[0m02:30:58.388524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3abaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c393c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb0bad0>]}
[0m02:30:58.389145 [debug] [MainThread]: Flushing usage events
[0m02:44:42.673993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb411bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47d9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c720f0>]}


============================== 02:44:42.678539 | fc1a0ac0-ad3a-4129-942d-c2f9206048e4 ==============================
[0m02:44:42.678539 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:44:42.679160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:44:43.155440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a2b8f0>]}
[0m02:44:43.179964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef79c40>]}
[0m02:44:43.180537 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:44:43.231493 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:44:43.328775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:44:43.329462 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://tests/stock_tests_2.sql
[0m02:44:43.329830 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://tests/stock_tests_1.sql
[0m02:44:43.422076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.transformations
- models.dbt.marts
- models.dbt.raw
- snapshots.dbt
[0m02:44:43.428617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9deb4ce0>]}
[0m02:44:43.512099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9decc1a0>]}
[0m02:44:43.512711 [info ] [MainThread]: Found 3 models, 1 snapshot, 9 data tests, 1 source, 460 macros
[0m02:44:43.513424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49ec500>]}
[0m02:44:43.514802 [info ] [MainThread]: 
[0m02:44:43.515354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:44:43.518914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m02:44:43.529581 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m02:44:43.529976 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m02:44:43.530287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:44.048713 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.518 seconds
[0m02:44:44.051409 [debug] [ThreadPool]: On list_stock: Close
[0m02:44:44.179914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m02:44:44.187572 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m02:44:44.188025 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m02:44:44.188421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:44.626537 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860e4-0004-2ced-0000-0002756ff599
[0m02:44:44.628220 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:44:44.629296 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:44:44.630032 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:44:44.630864 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m02:44:44.745861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m02:44:44.758345 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m02:44:44.773532 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m02:44:44.782968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:45.228028 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.447 seconds
[0m02:44:45.231099 [debug] [ThreadPool]: On list_stock_data: Close
[0m02:44:45.361990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5898e00>]}
[0m02:44:45.363802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:45.366038 [info ] [MainThread]: 
[0m02:44:45.383676 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m02:44:45.384875 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m02:44:45.386213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m02:44:45.386964 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m02:44:45.394795 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m02:44:45.397237 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m02:44:45.421842 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m02:44:45.424067 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m02:44:45.424486 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m02:44:45.424843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:46.022168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m02:44:46.040796 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m02:44:46.137187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e484a70>]}
[0m02:44:46.138529 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 0.75s]
[0m02:44:46.140303 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m02:44:46.142005 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m02:44:46.142668 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m02:44:46.143473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m02:44:46.143927 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m02:44:46.145934 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m02:44:46.147662 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m02:44:46.150881 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m02:44:46.152937 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m02:44:46.153354 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m02:44:46.153761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:46.732846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m02:44:46.736205 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m02:44:46.847643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d18b440>]}
[0m02:44:46.849017 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.70s]
[0m02:44:46.850568 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m02:44:46.851996 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m02:44:46.852925 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m02:44:46.853655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m02:44:46.853997 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m02:44:46.855826 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m02:44:46.857362 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m02:44:46.858777 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m02:44:46.860288 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m02:44:46.860612 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m02:44:46.860925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:47.436928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m02:44:47.441189 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m02:44:47.562505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1a0ac0-ad3a-4129-942d-c2f9206048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d164680>]}
[0m02:44:47.564211 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.71s]
[0m02:44:47.565963 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m02:44:47.567799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:47.568296 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m02:44:47.568644 [info ] [MainThread]: 
[0m02:44:47.569119 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m02:44:47.569844 [debug] [MainThread]: Command end result
[0m02:44:47.644107 [info ] [MainThread]: 
[0m02:44:47.644678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:47.645067 [info ] [MainThread]: 
[0m02:44:47.645392 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:44:47.646208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.026993, "process_user_time": 2.480225, "process_kernel_time": 0.305505, "process_mem_max_rss": "208804", "process_out_blocks": "2890", "process_in_blocks": "0"}
[0m02:44:47.646583 [debug] [MainThread]: Command `dbt run` succeeded at 02:44:47.646525 after 5.03 seconds
[0m02:44:47.646877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70b6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e276180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ec0620>]}
[0m02:44:47.647173 [debug] [MainThread]: Flushing usage events
[0m02:44:50.492224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dcbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e93ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e93b30>]}


============================== 02:44:50.496346 | 3111491c-1cf1-41a9-8dbb-2555b91dc7c0 ==============================
[0m02:44:50.496346 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:44:50.497003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:44:50.936926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3111491c-1cf1-41a9-8dbb-2555b91dc7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b82b8f0>]}
[0m02:44:50.962415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3111491c-1cf1-41a9-8dbb-2555b91dc7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b851400>]}
[0m02:44:50.963052 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:44:51.013888 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:44:51.108204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:44:51.108589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:44:51.111498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.marts
- models.dbt.transformations
- snapshots.dbt
[0m02:44:51.138302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3111491c-1cf1-41a9-8dbb-2555b91dc7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917d0920>]}
[0m02:44:51.225173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3111491c-1cf1-41a9-8dbb-2555b91dc7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae64aa0>]}
[0m02:44:51.225601 [info ] [MainThread]: Found 3 models, 1 snapshot, 9 data tests, 1 source, 460 macros
[0m02:44:51.226196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3111491c-1cf1-41a9-8dbb-2555b91dc7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af13ef0>]}
[0m02:44:51.227565 [info ] [MainThread]: 
[0m02:44:51.228119 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:44:51.230628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_snapshots'
[0m02:44:51.239688 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m02:44:51.240042 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m02:44:51.240302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:51.706544 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860e4-0004-2cf6-0002-756f000144f2
[0m02:44:51.707560 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:44:51.708407 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:44:51.709088 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:44:51.709938 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m02:44:51.855699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m02:44:51.871332 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m02:44:51.872221 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m02:44:51.873320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:52.298080 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.425 seconds
[0m02:44:52.302188 [debug] [ThreadPool]: On list_stock_data: Close
[0m02:44:52.415800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3111491c-1cf1-41a9-8dbb-2555b91dc7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae15340>]}
[0m02:44:52.417249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:52.418469 [info ] [MainThread]: 
[0m02:44:52.435342 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:44:52.436188 [info ] [Thread-1 (]: 1 of 9 START test not_null_stock_analysis_date ................................. [RUN]
[0m02:44:52.437199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m02:44:52.437768 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:44:52.454983 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m02:44:52.458563 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:44:52.473692 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m02:44:52.475883 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m02:44:52.476321 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m02:44:52.476723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:53.350974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.874 seconds
[0m02:44:53.366695 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m02:44:53.489741 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 1.05s]
[0m02:44:53.492365 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m02:44:53.493363 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:44:53.494233 [info ] [Thread-1 (]: 2 of 9 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m02:44:53.495440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m02:44:53.496246 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:44:53.502720 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m02:44:53.505639 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:44:53.508447 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m02:44:53.511311 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m02:44:53.511971 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m02:44:53.512736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.213890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m02:44:54.217265 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m02:44:54.317191 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.82s]
[0m02:44:54.318880 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m02:44:54.319855 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:44:54.320582 [info ] [Thread-1 (]: 3 of 9 START test not_null_stock_data_date ..................................... [RUN]
[0m02:44:54.321549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m02:44:54.322208 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:44:54.327475 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m02:44:54.329889 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:44:54.332525 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m02:44:54.334991 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m02:44:54.335616 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m02:44:54.336233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.934003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m02:44:54.939224 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m02:44:55.053555 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.73s]
[0m02:44:55.055328 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m02:44:55.056252 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:44:55.057040 [info ] [Thread-1 (]: 4 of 9 START test not_null_stock_data_open ..................................... [RUN]
[0m02:44:55.058272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_open.757f574b25)
[0m02:44:55.059177 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:44:55.065335 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m02:44:55.082253 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:44:55.085738 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m02:44:55.092780 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m02:44:55.093929 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_open.757f574b25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from stock.data.stock_data
where open is null



      
    ) dbt_internal_test
[0m02:44:55.095026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:55.522333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m02:44:55.527748 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: Close
[0m02:44:55.662697 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stock_data_open ........................................... [[32mPASS[0m in 0.60s]
[0m02:44:55.665444 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m02:44:55.666526 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:44:55.667362 [info ] [Thread-1 (]: 5 of 9 START test not_null_stock_data_symbol ................................... [RUN]
[0m02:44:55.668532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_open.757f574b25, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m02:44:55.669325 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:44:55.675853 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m02:44:55.678504 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:44:55.681367 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m02:44:55.683931 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m02:44:55.684598 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m02:44:55.685244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:56.244990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m02:44:56.247966 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m02:44:56.346651 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.68s]
[0m02:44:56.347879 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m02:44:56.348321 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:44:56.348678 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m02:44:56.349214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m02:44:56.349541 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:44:56.352302 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m02:44:56.353987 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:44:56.355412 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m02:44:56.357040 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m02:44:56.357392 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m02:44:56.357698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:56.770980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m02:44:56.777019 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m02:44:56.890725 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.54s]
[0m02:44:56.892415 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m02:44:56.893222 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:44:56.893907 [info ] [Thread-1 (]: 7 of 9 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m02:44:56.894847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m02:44:56.895517 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:44:56.900798 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m02:44:56.903792 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:44:56.906257 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m02:44:56.909014 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m02:44:56.909630 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m02:44:56.910125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:57.381927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m02:44:57.387295 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m02:44:57.516365 [info ] [Thread-1 (]: 7 of 9 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.62s]
[0m02:44:57.519049 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m02:44:57.521013 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests_1
[0m02:44:57.521909 [info ] [Thread-1 (]: 8 of 9 START test stock_tests_1 ................................................ [RUN]
[0m02:44:57.523431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.stock_tests_1)
[0m02:44:57.524256 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests_1
[0m02:44:57.528819 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests_1"
[0m02:44:57.539959 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests_1
[0m02:44:57.543904 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests_1"
[0m02:44:57.553443 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests_1"
[0m02:44:57.554125 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests_1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_no_nulls_in_date.sql
SELECT COUNT(*) = 0 AS test_passed
FROM stock.data.stock_data
WHERE date IS NULL
      
    ) dbt_internal_test
[0m02:44:57.554781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.168536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m02:44:58.171284 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_1: Close
[0m02:44:58.291624 [error] [Thread-1 (]: 8 of 9 FAIL 1 stock_tests_1 .................................................... [[31mFAIL 1[0m in 0.77s]
[0m02:44:58.293416 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests_1
[0m02:44:58.294190 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests_2
[0m02:44:58.294841 [info ] [Thread-1 (]: 9 of 9 START test stock_tests_2 ................................................ [RUN]
[0m02:44:58.295646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.stock_tests_1, now test.stock_analysis_project.stock_tests_2)
[0m02:44:58.296330 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests_2
[0m02:44:58.299862 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests_2"
[0m02:44:58.306948 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests_2
[0m02:44:58.310212 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests_2"
[0m02:44:58.315797 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests_2"
[0m02:44:58.316557 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests_2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_unique_date_symbol.sql
SELECT COUNT(*) = 0 AS test_passed
FROM (
    SELECT
        date,
        symbol,
        COUNT(*) AS record_count
    FROM stock.data.stock_data
    GROUP BY date, symbol
    HAVING COUNT(*) > 1
) duplicates
      
    ) dbt_internal_test
[0m02:44:58.317232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.924763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m02:44:58.929117 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_2: Close
[0m02:44:59.046251 [error] [Thread-1 (]: 9 of 9 FAIL 1 stock_tests_2 .................................................... [[31mFAIL 1[0m in 0.75s]
[0m02:44:59.049252 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests_2
[0m02:44:59.051852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:59.052691 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests_2' was properly closed.
[0m02:44:59.053595 [info ] [MainThread]: 
[0m02:44:59.054708 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 7.83 seconds (7.83s).
[0m02:44:59.057694 [debug] [MainThread]: Command end result
[0m02:44:59.180964 [info ] [MainThread]: 
[0m02:44:59.182188 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:44:59.182891 [info ] [MainThread]: 
[0m02:44:59.183668 [error] [MainThread]: [31mFailure in test stock_tests_1 (tests/stock_tests_1.sql)[0m
[0m02:44:59.184488 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:44:59.185000 [info ] [MainThread]: 
[0m02:44:59.185661 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/tests/stock_tests_1.sql
[0m02:44:59.186083 [info ] [MainThread]: 
[0m02:44:59.186601 [error] [MainThread]: [31mFailure in test stock_tests_2 (tests/stock_tests_2.sql)[0m
[0m02:44:59.187092 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:44:59.187669 [info ] [MainThread]: 
[0m02:44:59.188255 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/tests/stock_tests_2.sql
[0m02:44:59.188724 [info ] [MainThread]: 
[0m02:44:59.189075 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m02:44:59.190071 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 8.753672, "process_user_time": 2.794562, "process_kernel_time": 0.208789, "process_mem_max_rss": "209732", "process_out_blocks": "1992", "command_success": false, "process_in_blocks": "0"}
[0m02:44:59.190653 [debug] [MainThread]: Command `dbt test` failed at 02:44:59.190583 after 8.75 seconds
[0m02:44:59.190995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dcbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90371a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1104260>]}
[0m02:44:59.191311 [debug] [MainThread]: Flushing usage events
[0m03:05:01.078319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1e6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f83a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1e6030>]}


============================== 03:05:01.082700 | 01b2ce75-49e5-4e4b-9a78-ee8da75ec6be ==============================
[0m03:05:01.082700 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:05:01.083392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:05:01.562252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c183f50>]}
[0m03:05:01.589739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921d3950>]}
[0m03:05:01.590271 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:05:01.651657 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:05:01.756952 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m03:05:01.757374 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis_project://tests/stock_tests_2.sql
[0m03:05:01.802451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.transformations
- models.dbt.marts
- models.dbt.raw
- snapshots.dbt
[0m03:05:01.809260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cafec30>]}
[0m03:05:01.878891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f4c6b0>]}
[0m03:05:01.879294 [info ] [MainThread]: Found 3 models, 1 snapshot, 8 data tests, 1 source, 460 macros
[0m03:05:01.879847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c48590>]}
[0m03:05:01.881069 [info ] [MainThread]: 
[0m03:05:01.881557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:05:01.884006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m03:05:01.892058 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m03:05:01.892381 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m03:05:01.892615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:02.534009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.641 seconds
[0m03:05:02.538944 [debug] [ThreadPool]: On list_stock: Close
[0m03:05:02.662542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m03:05:02.678667 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m03:05:02.679379 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m03:05:02.680020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:03.246130 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860f9-0004-2cf6-0002-756f0001450a
[0m03:05:03.247296 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:05:03.248246 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:05:03.248969 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:05:03.249770 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m03:05:03.374334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m03:05:03.379814 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m03:05:03.380821 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m03:05:03.381725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:03.852407 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.470 seconds
[0m03:05:03.858043 [debug] [ThreadPool]: On list_stock_data: Close
[0m03:05:03.964453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5a1910>]}
[0m03:05:03.965643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:03.966991 [info ] [MainThread]: 
[0m03:05:03.983277 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m03:05:03.984332 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m03:05:03.985423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m03:05:03.986018 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m03:05:03.993417 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m03:05:04.006738 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m03:05:04.033505 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m03:05:04.071997 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m03:05:04.072575 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m03:05:04.073091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:04.873265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m03:05:04.890444 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m03:05:05.005653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e839f40>]}
[0m03:05:05.006347 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 1.02s]
[0m03:05:05.007157 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m03:05:05.008420 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m03:05:05.009139 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m03:05:05.010014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m03:05:05.010631 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m03:05:05.013252 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m03:05:05.020756 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m03:05:05.023643 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m03:05:05.033146 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m03:05:05.033613 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m03:05:05.034076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:05.837623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m03:05:05.843347 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m03:05:05.976044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b03140>]}
[0m03:05:05.977924 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.97s]
[0m03:05:05.979636 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m03:05:05.981222 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m03:05:05.982128 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m03:05:05.983331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m03:05:05.984096 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m03:05:05.988825 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m03:05:05.997739 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m03:05:06.001318 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m03:05:06.014989 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m03:05:06.015759 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m03:05:06.016414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:06.804059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.787 seconds
[0m03:05:06.811864 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m03:05:06.934240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b2ce75-49e5-4e4b-9a78-ee8da75ec6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b03b00>]}
[0m03:05:06.936632 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.95s]
[0m03:05:06.938946 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m03:05:06.941532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:06.942278 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m03:05:06.943119 [info ] [MainThread]: 
[0m03:05:06.944241 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m03:05:06.946213 [debug] [MainThread]: Command end result
[0m03:05:07.076505 [info ] [MainThread]: 
[0m03:05:07.077422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:07.077942 [info ] [MainThread]: 
[0m03:05:07.078463 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m03:05:07.079737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0551662, "process_user_time": 2.563634, "process_kernel_time": 0.30455, "process_mem_max_rss": "207288", "process_out_blocks": "2877", "process_in_blocks": "0"}
[0m03:05:07.080451 [debug] [MainThread]: Command `dbt run` succeeded at 03:05:07.080332 after 6.06 seconds
[0m03:05:07.080994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e112300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5a21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea81cd0>]}
[0m03:05:07.081493 [debug] [MainThread]: Flushing usage events
[0m03:05:09.886416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d08e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91901580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d08770>]}


============================== 03:05:09.890590 | 4bff5628-e4e8-4888-be78-b9aaddb157cf ==============================
[0m03:05:09.890590 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:05:09.891170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:05:10.334063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bff5628-e4e8-4888-be78-b9aaddb157cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808d8ce0>]}
[0m03:05:10.359143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bff5628-e4e8-4888-be78-b9aaddb157cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57e5a0>]}
[0m03:05:10.359781 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:05:10.409584 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:05:10.504206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:10.504591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:10.507446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.transformations
- models.dbt.marts
- snapshots.dbt
[0m03:05:10.534492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bff5628-e4e8-4888-be78-b9aaddb157cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a406180>]}
[0m03:05:10.624118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bff5628-e4e8-4888-be78-b9aaddb157cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79eec560>]}
[0m03:05:10.624586 [info ] [MainThread]: Found 3 models, 1 snapshot, 8 data tests, 1 source, 460 macros
[0m03:05:10.625102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bff5628-e4e8-4888-be78-b9aaddb157cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79eccb00>]}
[0m03:05:10.626464 [info ] [MainThread]: 
[0m03:05:10.626983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:05:10.629661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m03:05:10.639068 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m03:05:10.639399 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m03:05:10.639655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:11.198662 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.559 seconds
[0m03:05:11.203778 [debug] [ThreadPool]: On list_stock_data: Close
[0m03:05:11.312706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m03:05:11.319276 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m03:05:11.320115 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m03:05:11.320877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:11.772862 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b860f9-0004-2cef-0002-756f000180ee
[0m03:05:11.774584 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:05:11.776111 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:05:11.776937 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:05:11.777747 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m03:05:11.878356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bff5628-e4e8-4888-be78-b9aaddb157cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a098e00>]}
[0m03:05:11.880991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:11.883537 [info ] [MainThread]: 
[0m03:05:11.891622 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:05:11.892115 [info ] [Thread-1 (]: 1 of 8 START test not_null_stock_analysis_date ................................. [RUN]
[0m03:05:11.892580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m03:05:11.892981 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:05:11.904268 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m03:05:11.913646 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:05:11.926574 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m03:05:11.934414 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m03:05:11.934829 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m03:05:11.935222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:12.902808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m03:05:12.918063 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m03:05:13.030519 [info ] [Thread-1 (]: 1 of 8 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 1.14s]
[0m03:05:13.032355 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:05:13.033346 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:05:13.034234 [info ] [Thread-1 (]: 2 of 8 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m03:05:13.035369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m03:05:13.036143 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:05:13.042409 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m03:05:13.059803 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:05:13.063481 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m03:05:13.072800 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m03:05:13.073546 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m03:05:13.074230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:13.822061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m03:05:13.825426 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m03:05:13.962277 [info ] [Thread-1 (]: 2 of 8 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.93s]
[0m03:05:13.964058 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:05:13.964984 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:05:13.965842 [info ] [Thread-1 (]: 3 of 8 START test not_null_stock_data_date ..................................... [RUN]
[0m03:05:13.966708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m03:05:13.967552 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:05:13.974004 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m03:05:13.987714 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:05:13.992305 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m03:05:14.000445 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m03:05:14.001062 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m03:05:14.001668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:14.743271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m03:05:14.748613 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m03:05:14.859704 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.89s]
[0m03:05:14.860971 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:05:14.861625 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:05:14.862224 [info ] [Thread-1 (]: 4 of 8 START test not_null_stock_data_open ..................................... [RUN]
[0m03:05:14.863044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_open.757f574b25)
[0m03:05:14.863682 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:05:14.868248 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m03:05:14.871068 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:05:14.873261 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m03:05:14.875569 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m03:05:14.876031 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_open.757f574b25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from stock.data.stock_data
where open is null



      
    ) dbt_internal_test
[0m03:05:14.876478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:15.348257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m03:05:15.353752 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: Close
[0m03:05:15.458794 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stock_data_open ........................................... [[32mPASS[0m in 0.59s]
[0m03:05:15.461472 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:05:15.462566 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:05:15.463385 [info ] [Thread-1 (]: 5 of 8 START test not_null_stock_data_symbol ................................... [RUN]
[0m03:05:15.464625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_open.757f574b25, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m03:05:15.465382 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:05:15.471922 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m03:05:15.487561 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:05:15.491281 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m03:05:15.500559 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m03:05:15.501395 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m03:05:15.502568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:16.286631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m03:05:16.292992 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m03:05:16.404874 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.94s]
[0m03:05:16.407943 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:05:16.409506 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:05:16.410403 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m03:05:16.411899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m03:05:16.412827 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:05:16.419756 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m03:05:16.434941 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:05:16.438558 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m03:05:16.447924 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m03:05:16.448852 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m03:05:16.449560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:16.839374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m03:05:16.845270 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m03:05:17.000050 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.59s]
[0m03:05:17.001921 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:05:17.002852 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:05:17.003796 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m03:05:17.005303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m03:05:17.006127 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:05:17.012474 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m03:05:17.028418 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:05:17.033746 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m03:05:17.041696 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m03:05:17.042418 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m03:05:17.043106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:17.506420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m03:05:17.511956 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m03:05:17.624602 [info ] [Thread-1 (]: 7 of 8 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.62s]
[0m03:05:17.626094 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:05:17.627000 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.stock_tests_1
[0m03:05:17.628008 [info ] [Thread-1 (]: 8 of 8 START test stock_tests_1 ................................................ [RUN]
[0m03:05:17.628796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d, now test.stock_analysis_project.stock_tests_1)
[0m03:05:17.629455 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.stock_tests_1
[0m03:05:17.633077 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.stock_tests_1"
[0m03:05:17.637321 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.stock_tests_1
[0m03:05:17.640368 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.stock_tests_1"
[0m03:05:17.643653 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.stock_tests_1"
[0m03:05:17.644301 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.stock_tests_1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_no_nulls_in_date.sql
SELECT COUNT(*) = 0 AS test_passed
FROM stock.data.stock_data
WHERE date IS NULL
      
    ) dbt_internal_test
[0m03:05:17.644829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:18.417620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m03:05:18.422933 [debug] [Thread-1 (]: On test.stock_analysis_project.stock_tests_1: Close
[0m03:05:18.537552 [error] [Thread-1 (]: 8 of 8 FAIL 1 stock_tests_1 .................................................... [[31mFAIL 1[0m in 0.91s]
[0m03:05:18.540315 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.stock_tests_1
[0m03:05:18.543625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:18.544403 [debug] [MainThread]: Connection 'test.stock_analysis_project.stock_tests_1' was properly closed.
[0m03:05:18.545223 [info ] [MainThread]: 
[0m03:05:18.546485 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m03:05:18.549077 [debug] [MainThread]: Command end result
[0m03:05:18.686837 [info ] [MainThread]: 
[0m03:05:18.687721 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:05:18.688272 [info ] [MainThread]: 
[0m03:05:18.688809 [error] [MainThread]: [31mFailure in test stock_tests_1 (tests/stock_tests_1.sql)[0m
[0m03:05:18.689263 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m03:05:18.689598 [info ] [MainThread]: 
[0m03:05:18.689956 [info ] [MainThread]:   compiled code at target/compiled/stock_analysis_project/tests/stock_tests_1.sql
[0m03:05:18.690336 [info ] [MainThread]: 
[0m03:05:18.690692 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m03:05:18.691623 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 8.857128, "process_user_time": 2.683251, "process_kernel_time": 0.232761, "process_mem_max_rss": "209404", "process_out_blocks": "1974", "command_success": false, "process_in_blocks": "0"}
[0m03:05:18.692115 [debug] [MainThread]: Command `dbt test` failed at 03:05:18.692041 after 8.86 seconds
[0m03:05:18.692531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9134c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3f2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9085e870>]}
[0m03:05:18.692893 [debug] [MainThread]: Flushing usage events
[0m03:12:08.140538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99271160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992762a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a66f860>]}


============================== 03:12:08.144964 | e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1 ==============================
[0m03:12:08.144964 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:12:08.145564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:12:08.644833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89668ce0>]}
[0m03:12:08.673032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8966b950>]}
[0m03:12:08.673754 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:12:08.727257 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:12:08.865102 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m03:12:08.865679 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis_project://tests/stock_tests_1.sql
[0m03:12:08.916132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m03:12:08.923927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830ada60>]}
[0m03:12:08.994048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82db3650>]}
[0m03:12:08.994527 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m03:12:08.995122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830e1eb0>]}
[0m03:12:08.996243 [info ] [MainThread]: 
[0m03:12:08.996771 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:12:09.000002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m03:12:09.008276 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m03:12:09.008626 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m03:12:09.008875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:09.599924 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.591 seconds
[0m03:12:09.604168 [debug] [ThreadPool]: On list_stock: Close
[0m03:12:09.737935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_STOCK_snapshots)
[0m03:12:09.753385 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m03:12:09.754102 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m03:12:09.754708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:10.248697 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86100-0004-2cec-0002-756f0001753e
[0m03:12:10.250306 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:12:10.251615 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:12:10.252351 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:12:10.253186 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m03:12:10.379299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now list_stock_data)
[0m03:12:10.383189 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m03:12:10.384045 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m03:12:10.384829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:10.870096 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.485 seconds
[0m03:12:10.871674 [debug] [ThreadPool]: On list_stock_data: Close
[0m03:12:10.973053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a839130>]}
[0m03:12:10.973851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:10.975107 [info ] [MainThread]: 
[0m03:12:10.987253 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m03:12:10.987973 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m03:12:10.988749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_data, now model.stock_analysis_project.stock_data)
[0m03:12:10.989250 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m03:12:10.994972 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m03:12:10.997251 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m03:12:11.017747 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m03:12:11.020089 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m03:12:11.020423 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m03:12:11.020738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:11.727202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m03:12:11.762551 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m03:12:11.898671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83410590>]}
[0m03:12:11.900127 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m03:12:11.901999 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m03:12:11.903825 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m03:12:11.904826 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m03:12:11.905744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m03:12:11.906495 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m03:12:11.910318 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m03:12:11.915658 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m03:12:11.920654 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m03:12:11.923199 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m03:12:11.923764 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    SUM(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS rsi_14d
FROM stock.data.stock_data
  );
[0m03:12:11.924640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:12.646501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m03:12:12.650118 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m03:12:12.789840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822a8e30>]}
[0m03:12:12.791899 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.88s]
[0m03:12:12.794029 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m03:12:12.795580 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m03:12:12.797135 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m03:12:12.798750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m03:12:12.799621 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m03:12:12.804108 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m03:12:12.807451 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m03:12:12.810643 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m03:12:12.813594 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m03:12:12.814260 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m03:12:12.814938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:13.566373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m03:12:13.569202 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m03:12:13.663416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5b2e-faeb-49e4-86a5-18bcb3c4cca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c964e0>]}
[0m03:12:13.665339 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.86s]
[0m03:12:13.667278 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m03:12:13.669787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:13.670592 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m03:12:13.671443 [info ] [MainThread]: 
[0m03:12:13.672633 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m03:12:13.674592 [debug] [MainThread]: Command end result
[0m03:12:13.803592 [info ] [MainThread]: 
[0m03:12:13.804602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:13.805231 [info ] [MainThread]: 
[0m03:12:13.805864 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m03:12:13.807430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7189884, "process_user_time": 2.52334, "process_kernel_time": 0.30853, "process_mem_max_rss": "207224", "process_out_blocks": "2866", "process_in_blocks": "0"}
[0m03:12:13.808187 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:13.808062 after 5.72 seconds
[0m03:12:13.808735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ba780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e83800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c052390>]}
[0m03:12:13.809209 [debug] [MainThread]: Flushing usage events
[0m03:12:16.588245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e57c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddf77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddf4bf0>]}


============================== 03:12:16.592426 | 9b046e97-175e-4d46-84d7-e5918279beb4 ==============================
[0m03:12:16.592426 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:12:16.593063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m03:12:17.030140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b046e97-175e-4d46-84d7-e5918279beb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e170ce0>]}
[0m03:12:17.054496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b046e97-175e-4d46-84d7-e5918279beb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e11a870>]}
[0m03:12:17.055063 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:12:17.103958 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:12:17.188069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:17.188408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:17.191033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.raw
- models.dbt.marts
- models.dbt.transformations
- snapshots.dbt
[0m03:12:17.213328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b046e97-175e-4d46-84d7-e5918279beb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77c409b0>]}
[0m03:12:17.291710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b046e97-175e-4d46-84d7-e5918279beb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77959670>]}
[0m03:12:17.292153 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m03:12:17.292699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b046e97-175e-4d46-84d7-e5918279beb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77949cd0>]}
[0m03:12:17.294065 [info ] [MainThread]: 
[0m03:12:17.294606 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:12:17.297278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m03:12:17.306687 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m03:12:17.307000 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m03:12:17.307262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:17.714017 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.406 seconds
[0m03:12:17.719168 [debug] [ThreadPool]: On list_stock_data: Close
[0m03:12:17.830322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m03:12:17.836204 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m03:12:17.836994 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m03:12:17.837698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:18.296225 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86100-0004-2cf5-0002-756f0001557a
[0m03:12:18.298105 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:12:18.299593 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:12:18.300468 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:12:18.301267 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m03:12:18.426256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b046e97-175e-4d46-84d7-e5918279beb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777036e0>]}
[0m03:12:18.428110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:18.429646 [info ] [MainThread]: 
[0m03:12:18.446200 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:12:18.447016 [info ] [Thread-1 (]: 1 of 7 START test not_null_stock_analysis_date ................................. [RUN]
[0m03:12:18.448059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m03:12:18.448781 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:12:18.466364 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m03:12:18.469226 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:12:18.485060 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m03:12:18.487144 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m03:12:18.487542 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m03:12:18.487934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:19.033051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m03:12:19.048806 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m03:12:19.173630 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 0.72s]
[0m03:12:19.176814 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m03:12:19.178343 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:12:19.179590 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m03:12:19.181127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m03:12:19.181897 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:12:19.188452 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m03:12:19.192943 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:12:19.196156 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m03:12:19.199462 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m03:12:19.200171 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m03:12:19.200820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:19.826618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m03:12:19.832434 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m03:12:19.938713 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.76s]
[0m03:12:19.941240 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m03:12:19.942554 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:12:19.943465 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_data_date ..................................... [RUN]
[0m03:12:19.944882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m03:12:19.945980 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:12:19.952576 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m03:12:19.955673 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:12:19.960469 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m03:12:19.963926 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m03:12:19.964639 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m03:12:19.965436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:20.506921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m03:12:20.511300 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m03:12:20.611922 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.67s]
[0m03:12:20.613269 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m03:12:20.613984 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:12:20.614640 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_data_open ..................................... [RUN]
[0m03:12:20.615468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_open.757f574b25)
[0m03:12:20.616067 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:12:20.620611 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m03:12:20.642400 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:12:20.645081 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m03:12:20.652884 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m03:12:20.653674 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_open.757f574b25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from stock.data.stock_data
where open is null



      
    ) dbt_internal_test
[0m03:12:20.654363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:21.139993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m03:12:21.143291 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: Close
[0m03:12:21.256734 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_data_open ........................................... [[32mPASS[0m in 0.64s]
[0m03:12:21.259482 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m03:12:21.260652 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:12:21.261592 [info ] [Thread-1 (]: 5 of 7 START test not_null_stock_data_symbol ................................... [RUN]
[0m03:12:21.262822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_open.757f574b25, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m03:12:21.263655 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:12:21.270148 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m03:12:21.272644 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:12:21.275541 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m03:12:21.278025 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m03:12:21.278812 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m03:12:21.279421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:21.689560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m03:12:21.693549 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m03:12:21.810724 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.55s]
[0m03:12:21.813589 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m03:12:21.815054 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:12:21.816079 [info ] [Thread-1 (]: 6 of 7 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m03:12:21.817431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m03:12:21.818349 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:12:21.825170 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m03:12:21.827924 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:12:21.830793 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m03:12:21.833257 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m03:12:21.833906 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m03:12:21.834506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:22.316264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m03:12:22.321365 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m03:12:22.428846 [info ] [Thread-1 (]: 6 of 7 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.61s]
[0m03:12:22.430168 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m03:12:22.431280 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:12:22.431763 [info ] [Thread-1 (]: 7 of 7 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m03:12:22.432642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m03:12:22.433091 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:12:22.436223 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m03:12:22.441341 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:12:22.444551 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m03:12:22.445660 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m03:12:22.445918 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m03:12:22.446159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:22.852716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m03:12:22.858369 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m03:12:22.988465 [info ] [Thread-1 (]: 7 of 7 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.55s]
[0m03:12:22.991253 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m03:12:22.994148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:22.994973 [debug] [MainThread]: Connection 'test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d' was properly closed.
[0m03:12:22.995691 [info ] [MainThread]: 
[0m03:12:22.996812 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m03:12:22.998964 [debug] [MainThread]: Command end result
[0m03:12:23.129032 [info ] [MainThread]: 
[0m03:12:23.130152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:23.130760 [info ] [MainThread]: 
[0m03:12:23.131599 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m03:12:23.133073 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.5968585, "process_user_time": 2.579999, "process_kernel_time": 0.221286, "process_mem_max_rss": "209308", "process_out_blocks": "1958", "process_in_blocks": "0"}
[0m03:12:23.133834 [debug] [MainThread]: Command `dbt test` succeeded at 03:12:23.133719 after 6.60 seconds
[0m03:12:23.134381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e57c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff776d33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0ab0e0>]}
[0m03:12:23.134909 [debug] [MainThread]: Flushing usage events
[0m03:12:25.578568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3917e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b421b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4afe360>]}


============================== 03:12:25.582368 | 7cfb0f6b-4528-4966-acee-137642c5906c ==============================
[0m03:12:25.582368 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:12:25.582928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:12:25.981529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40e8ce0>]}
[0m03:12:26.005747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0aac90>]}
[0m03:12:26.006278 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:12:26.054642 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:12:26.132428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:26.132771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:26.135497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m03:12:26.158258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd53c20>]}
[0m03:12:26.217906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dafd790>]}
[0m03:12:26.218290 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m03:12:26.218789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbd15e0>]}
[0m03:12:26.219854 [info ] [MainThread]: 
[0m03:12:26.220437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:12:26.221057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK'
[0m03:12:26.228666 [debug] [ThreadPool]: Using snowflake connection "list_STOCK"
[0m03:12:26.228972 [debug] [ThreadPool]: On list_STOCK: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK"} */
show terse schemas in database STOCK
    limit 10000
[0m03:12:26.229207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:26.657098 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.428 seconds
[0m03:12:26.660499 [debug] [ThreadPool]: On list_STOCK: Close
[0m03:12:26.772627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK, now create_STOCK_snapshots)
[0m03:12:26.774252 [debug] [ThreadPool]: Creating schema "database: "STOCK"
schema: "snapshots"
"
[0m03:12:26.782443 [debug] [ThreadPool]: Using snowflake connection "create_STOCK_snapshots"
[0m03:12:26.783335 [debug] [ThreadPool]: On create_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "create_STOCK_snapshots"} */
create schema if not exists STOCK.snapshots
[0m03:12:26.784153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:27.260744 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.477 seconds
[0m03:12:27.261832 [debug] [ThreadPool]: On create_STOCK_snapshots: Close
[0m03:12:27.379910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_STOCK_snapshots, now list_stock_data)
[0m03:12:27.389202 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m03:12:27.389801 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m03:12:27.390312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:27.771448 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.381 seconds
[0m03:12:27.777064 [debug] [ThreadPool]: On list_stock_data: Close
[0m03:12:27.894900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m03:12:27.904109 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m03:12:27.905029 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m03:12:27.905670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:28.305301 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.399 seconds
[0m03:12:28.309594 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m03:12:28.456132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbc2960>]}
[0m03:12:28.458629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:28.462086 [info ] [MainThread]: 
[0m03:12:28.478702 [debug] [Thread-1 (]: Began running node snapshot.stock_analysis_project.stock_snapshot
[0m03:12:28.479954 [info ] [Thread-1 (]: 1 of 1 START snapshot STOCK.snapshots.stock_snapshot ........................... [RUN]
[0m03:12:28.481334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now snapshot.stock_analysis_project.stock_snapshot)
[0m03:12:28.482063 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analysis_project.stock_snapshot
[0m03:12:28.492112 [debug] [Thread-1 (]: Began executing node snapshot.stock_analysis_project.stock_snapshot
[0m03:12:28.547317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m03:12:28.547782 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date_symbol as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        
    
    
    SELECT 
        date,
        symbol,
        open,
        high,
        low,
        close,
        volume,
        CONCAT(date, '_', symbol) AS date_symbol,
        CURRENT_TIMESTAMP AS updated_at
    FROM stock.data.stock_data
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m03:12:28.548147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:28.951134 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.402 seconds
[0m03:12:28.962051 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m03:12:28.962939 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:12:29.095026 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.131 seconds
[0m03:12:29.097472 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analysis_project.stock_snapshot"
[0m03:12:29.105456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m03:12:29.106490 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
create or replace transient table STOCK.snapshots.stock_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(date_symbol as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        
    
    
    SELECT 
        date,
        symbol,
        open,
        high,
        low,
        close,
        volume,
        CONCAT(date, '_', symbol) AS date_symbol,
        CURRENT_TIMESTAMP AS updated_at
    FROM stock.data.stock_data
    ) sbq



        );
[0m03:12:30.159309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.051 seconds
[0m03:12:30.194242 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: Close
[0m03:12:30.303170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cfb0f6b-4528-4966-acee-137642c5906c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df00aa0>]}
[0m03:12:30.304910 [info ] [Thread-1 (]: 1 of 1 OK snapshotted STOCK.snapshots.stock_snapshot ........................... [[32mSUCCESS 1[0m in 1.82s]
[0m03:12:30.306860 [debug] [Thread-1 (]: Finished running node snapshot.stock_analysis_project.stock_snapshot
[0m03:12:30.309372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:30.310180 [debug] [MainThread]: Connection 'snapshot.stock_analysis_project.stock_snapshot' was properly closed.
[0m03:12:30.310895 [info ] [MainThread]: 
[0m03:12:30.311925 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m03:12:30.313496 [debug] [MainThread]: Command end result
[0m03:12:30.437402 [info ] [MainThread]: 
[0m03:12:30.438971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:30.440037 [info ] [MainThread]: 
[0m03:12:30.441854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:12:30.443990 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.913253, "process_user_time": 2.282272, "process_kernel_time": 0.145144, "process_mem_max_rss": "206376", "process_out_blocks": "1919", "process_in_blocks": "0"}
[0m03:12:30.445307 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:12:30.445153 after 4.91 seconds
[0m03:12:30.445859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4eb0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d95e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dcf2cc0>]}
[0m03:12:30.446394 [debug] [MainThread]: Flushing usage events
[0m07:34:09.004932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c3a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b1deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a87740>]}


============================== 07:34:09.009887 | 9a7c41c1-0937-4d55-a93f-9f5ba86c93e5 ==============================
[0m07:34:09.009887 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:34:09.010537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:34:09.516493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a7c41c1-0937-4d55-a93f-9f5ba86c93e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94def950>]}
[0m07:34:09.541714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a7c41c1-0937-4d55-a93f-9f5ba86c93e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de6ac60>]}
[0m07:34:09.542373 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:34:09.592566 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:34:09.684894 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m07:34:09.685378 [debug] [MainThread]: Partial parsing: added file: stock_analysis_project://models/transformations/moving_average.sql
[0m07:34:09.685660 [debug] [MainThread]: Partial parsing: added file: stock_analysis_project://models/transformations/rsi.sql
[0m07:34:09.685964 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis_project://models/transformations/stock_analysis.sql
[0m07:34:09.793072 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:34:09.793734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9a7c41c1-0937-4d55-a93f-9f5ba86c93e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6453a0>]}
[0m07:34:09.799923 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_analysis' in the 'models' section of file 'models/schema.yml'
[0m07:34:09.838710 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis_project.stock_mart' (models/marts/stock_mart.sql) depends on a node named 'stock_analysis' which was not found
[0m07:34:09.839617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8967773, "process_user_time": 1.963014, "process_kernel_time": 0.237001, "process_mem_max_rss": "201452", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m07:34:09.840060 [debug] [MainThread]: Command `dbt run` failed at 07:34:09.839999 after 0.90 seconds
[0m07:34:09.840385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0367d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d687710>]}
[0m07:34:09.840659 [debug] [MainThread]: Flushing usage events
[0m07:43:15.346089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53f0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53f0da0>]}


============================== 07:43:15.350718 | 65b56ea7-2183-40e1-81ed-e4ad91aa930f ==============================
[0m07:43:15.350718 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:43:15.351432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m07:43:15.846968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f17ce0>]}
[0m07:43:15.871720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5f82c0>]}
[0m07:43:15.872280 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:43:15.924213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:43:16.012864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:43:16.013385 [debug] [MainThread]: Partial parsing: updated file: stock_analysis_project://models/transformations/stock_analysis.sql
[0m07:43:16.114595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:43:16.115219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f61a390>]}
[0m07:43:16.195512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m07:43:16.202309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f61a3c0>]}
[0m07:43:16.266264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f30acc0>]}
[0m07:43:16.266908 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m07:43:16.267437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f73b230>]}
[0m07:43:16.268528 [info ] [MainThread]: 
[0m07:43:16.268998 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:43:16.271431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock'
[0m07:43:16.278651 [debug] [ThreadPool]: Using snowflake connection "list_stock"
[0m07:43:16.279006 [debug] [ThreadPool]: On list_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock"} */
show terse schemas in database stock
    limit 10000
[0m07:43:16.279254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:16.826048 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.546 seconds
[0m07:43:16.830771 [debug] [ThreadPool]: On list_stock: Close
[0m07:43:16.949238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock, now list_stock_data)
[0m07:43:16.963950 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m07:43:16.964694 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m07:43:16.965276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:17.429011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.463 seconds
[0m07:43:17.434815 [debug] [ThreadPool]: On list_stock_data: Close
[0m07:43:17.580582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m07:43:17.586755 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m07:43:17.587742 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m07:43:17.588391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:18.006176 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.417 seconds
[0m07:43:18.010802 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m07:43:18.144545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b7e00>]}
[0m07:43:18.146374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:18.148568 [info ] [MainThread]: 
[0m07:43:18.164091 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_data
[0m07:43:18.165030 [info ] [Thread-1 (]: 1 of 3 START sql view model data.stock_data .................................... [RUN]
[0m07:43:18.166120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now model.stock_analysis_project.stock_data)
[0m07:43:18.166807 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_data
[0m07:43:18.174420 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_data"
[0m07:43:18.177443 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_data
[0m07:43:18.203854 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_data"
[0m07:43:18.206243 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_data"
[0m07:43:18.206696 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_data"} */
create or replace   view stock.data.stock_data
  
   as (
    -- models/raw/stock_data.sql
SELECT *
FROM STOCK.data.market_dat
  );
[0m07:43:18.207065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:18.911058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m07:43:18.944402 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_data: Close
[0m07:43:19.057243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f1e330>]}
[0m07:43:19.058351 [info ] [Thread-1 (]: 1 of 3 OK created sql view model data.stock_data ............................... [[32mSUCCESS 1[0m in 0.89s]
[0m07:43:19.059604 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_data
[0m07:43:19.060756 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_analysis
[0m07:43:19.061458 [info ] [Thread-1 (]: 2 of 3 START sql view model data.stock_analysis ................................ [RUN]
[0m07:43:19.062345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_data, now model.stock_analysis_project.stock_analysis)
[0m07:43:19.062898 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_analysis
[0m07:43:19.066080 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_analysis"
[0m07:43:19.069157 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_analysis
[0m07:43:19.071598 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_analysis"
[0m07:43:19.075086 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_analysis"
[0m07:43:19.075650 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_analysis"} */
create or replace   view stock.data.stock_analysis
  
   as (
    -- models/transformations/stock_analysis.sql
WITH PriceChange AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM stock.data.stock_data
),
GainsLosses AS (
    SELECT
        date,
        symbol,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM PriceChange
)
SELECT
    date,
    symbol,
    close,
    -- 7-day moving average
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d,
    -- RSI calculation
    CASE 
        WHEN AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 0 THEN 100
        ELSE 100 - (100 / (1 + (
            AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) /
            AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW)
        )))
    END AS rsi_14d
FROM GainsLosses
ORDER BY symbol, date
  );
[0m07:43:19.076155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:19.840482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m07:43:19.842426 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_analysis: Close
[0m07:43:19.936040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e974920>]}
[0m07:43:19.937854 [info ] [Thread-1 (]: 2 of 3 OK created sql view model data.stock_analysis ........................... [[32mSUCCESS 1[0m in 0.87s]
[0m07:43:19.939231 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_analysis
[0m07:43:19.940465 [debug] [Thread-1 (]: Began running node model.stock_analysis_project.stock_mart
[0m07:43:19.941265 [info ] [Thread-1 (]: 3 of 3 START sql view model data.stock_mart .................................... [RUN]
[0m07:43:19.942248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analysis_project.stock_analysis, now model.stock_analysis_project.stock_mart)
[0m07:43:19.942926 [debug] [Thread-1 (]: Began compiling node model.stock_analysis_project.stock_mart
[0m07:43:19.946695 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analysis_project.stock_mart"
[0m07:43:19.949792 [debug] [Thread-1 (]: Began executing node model.stock_analysis_project.stock_mart
[0m07:43:19.952362 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analysis_project.stock_mart"
[0m07:43:19.955213 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analysis_project.stock_mart"
[0m07:43:19.955802 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "model.stock_analysis_project.stock_mart"} */
create or replace   view stock.data.stock_mart
  
   as (
    -- models/marts/stock_mart.sql
SELECT
    date,
    symbol,
    close,
    moving_avg_7d,
    rsi_14d
FROM stock.data.stock_analysis
WHERE date >= CURRENT_DATE - INTERVAL '90 DAY'
  );
[0m07:43:19.956377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:20.695616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m07:43:20.700480 [debug] [Thread-1 (]: On model.stock_analysis_project.stock_mart: Close
[0m07:43:20.818365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b56ea7-2183-40e1-81ed-e4ad91aa930f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5bb410>]}
[0m07:43:20.820280 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.stock_mart ............................... [[32mSUCCESS 1[0m in 0.88s]
[0m07:43:20.822116 [debug] [Thread-1 (]: Finished running node model.stock_analysis_project.stock_mart
[0m07:43:20.824376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:20.825173 [debug] [MainThread]: Connection 'model.stock_analysis_project.stock_mart' was properly closed.
[0m07:43:20.826095 [info ] [MainThread]: 
[0m07:43:20.827174 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m07:43:20.829142 [debug] [MainThread]: Command end result
[0m07:43:20.960475 [info ] [MainThread]: 
[0m07:43:20.961378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:20.963219 [info ] [MainThread]: 
[0m07:43:20.964255 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:43:20.968700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.67535, "process_user_time": 2.686716, "process_kernel_time": 0.316143, "process_mem_max_rss": "211472", "process_out_blocks": "2881", "process_in_blocks": "0"}
[0m07:43:20.969461 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:20.969354 after 5.68 seconds
[0m07:43:20.970274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2847d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53f0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5db080>]}
[0m07:43:20.971019 [debug] [MainThread]: Flushing usage events
[0m07:43:23.151389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c848bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c84a1e0>]}


============================== 07:43:23.155361 | 9c135031-a4e1-4758-9728-4e3f22afa90a ==============================
[0m07:43:23.155361 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:43:23.156071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:23.614074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c135031-a4e1-4758-9728-4e3f22afa90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9ba7e0>]}
[0m07:43:23.639356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c135031-a4e1-4758-9728-4e3f22afa90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b33a40>]}
[0m07:43:23.640017 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:43:23.689680 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:43:23.772641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:23.773000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:23.775753 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.marts
- models.dbt.raw
- models.dbt.transformations
- snapshots.dbt
[0m07:43:23.798459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c135031-a4e1-4758-9728-4e3f22afa90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86652390>]}
[0m07:43:23.913934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c135031-a4e1-4758-9728-4e3f22afa90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863a0da0>]}
[0m07:43:23.914489 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m07:43:23.915225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c135031-a4e1-4758-9728-4e3f22afa90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86651cd0>]}
[0m07:43:23.916821 [info ] [MainThread]: 
[0m07:43:23.917584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:43:23.920849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_data'
[0m07:43:23.931704 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m07:43:23.932066 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m07:43:23.932355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:24.442902 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.510 seconds
[0m07:43:24.447340 [debug] [ThreadPool]: On list_stock_data: Close
[0m07:43:24.562886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m07:43:24.569577 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m07:43:24.570596 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m07:43:24.571435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:25.071574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.500 seconds
[0m07:43:25.075987 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m07:43:25.185050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c135031-a4e1-4758-9728-4e3f22afa90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de10fb0>]}
[0m07:43:25.186931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:25.188396 [info ] [MainThread]: 
[0m07:43:25.204388 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m07:43:25.205258 [info ] [Thread-1 (]: 1 of 7 START test not_null_stock_analysis_date ................................. [RUN]
[0m07:43:25.206384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152)
[0m07:43:25.207049 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m07:43:25.224550 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m07:43:25.227726 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m07:43:25.243850 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m07:43:25.246490 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"
[0m07:43:25.246910 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_analysis
where date is null



      
    ) dbt_internal_test
[0m07:43:25.247259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:26.190468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m07:43:26.204284 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152: Close
[0m07:43:26.320359 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stock_analysis_date ....................................... [[32mPASS[0m in 1.11s]
[0m07:43:26.321262 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152
[0m07:43:26.321733 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m07:43:26.322161 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_analysis_symbol ............................... [RUN]
[0m07:43:26.322722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_date.7fedb07152, now test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07)
[0m07:43:26.323096 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m07:43:26.325968 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m07:43:26.328074 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m07:43:26.329609 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m07:43:26.331436 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"
[0m07:43:26.331791 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_analysis
where symbol is null



      
    ) dbt_internal_test
[0m07:43:26.332113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:27.093010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m07:43:27.096020 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07: Close
[0m07:43:27.195140 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_analysis_symbol ..................................... [[32mPASS[0m in 0.87s]
[0m07:43:27.196992 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07
[0m07:43:27.197904 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m07:43:27.198725 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_data_date ..................................... [RUN]
[0m07:43:27.199842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_analysis_symbol.84c4780b07, now test.stock_analysis_project.not_null_stock_data_date.c382ac52cf)
[0m07:43:27.200761 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m07:43:27.208800 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m07:43:27.211616 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m07:43:27.214510 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m07:43:27.217644 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"
[0m07:43:27.218268 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_date.c382ac52cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from stock.data.stock_data
where date is null



      
    ) dbt_internal_test
[0m07:43:27.218874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:27.828348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m07:43:27.832564 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_date.c382ac52cf: Close
[0m07:43:27.987416 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stock_data_date ........................................... [[32mPASS[0m in 0.79s]
[0m07:43:27.990212 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_date.c382ac52cf
[0m07:43:27.991776 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m07:43:27.992781 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_data_open ..................................... [RUN]
[0m07:43:27.994437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_date.c382ac52cf, now test.stock_analysis_project.not_null_stock_data_open.757f574b25)
[0m07:43:27.995356 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m07:43:28.001931 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m07:43:28.005936 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m07:43:28.008869 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m07:43:28.012005 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_open.757f574b25"
[0m07:43:28.012721 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_open.757f574b25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from stock.data.stock_data
where open is null



      
    ) dbt_internal_test
[0m07:43:28.013373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:28.417537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m07:43:28.422828 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_open.757f574b25: Close
[0m07:43:28.542679 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_data_open ........................................... [[32mPASS[0m in 0.55s]
[0m07:43:28.545610 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_open.757f574b25
[0m07:43:28.546863 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m07:43:28.547875 [info ] [Thread-1 (]: 5 of 7 START test not_null_stock_data_symbol ................................... [RUN]
[0m07:43:28.549244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_open.757f574b25, now test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a)
[0m07:43:28.550078 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m07:43:28.556885 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m07:43:28.560564 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m07:43:28.563420 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m07:43:28.566385 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"
[0m07:43:28.567078 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from stock.data.stock_data
where symbol is null



      
    ) dbt_internal_test
[0m07:43:28.567730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:29.073219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m07:43:29.079172 [debug] [Thread-1 (]: On test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a: Close
[0m07:43:29.189177 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stock_data_symbol ......................................... [[32mPASS[0m in 0.64s]
[0m07:43:29.192090 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a
[0m07:43:29.193085 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m07:43:29.193959 [info ] [Thread-1 (]: 6 of 7 START test source_not_null_stock_data_source_market_dat_date ............ [RUN]
[0m07:43:29.195211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.not_null_stock_data_symbol.791c3e587a, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9)
[0m07:43:29.196016 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m07:43:29.202769 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m07:43:29.207454 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m07:43:29.210269 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m07:43:29.213318 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"
[0m07:43:29.213983 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from STOCK.data.market_dat
where date is null



      
    ) dbt_internal_test
[0m07:43:29.214532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:29.741251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m07:43:29.745181 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9: Close
[0m07:43:29.865389 [info ] [Thread-1 (]: 6 of 7 PASS source_not_null_stock_data_source_market_dat_date .................. [[32mPASS[0m in 0.67s]
[0m07:43:29.866956 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9
[0m07:43:29.867732 [debug] [Thread-1 (]: Began running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m07:43:29.868427 [info ] [Thread-1 (]: 7 of 7 START test source_not_null_stock_data_source_market_dat_symbol .......... [RUN]
[0m07:43:29.869453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analysis_project.source_not_null_stock_data_source_market_dat_date.032ebcfbd9, now test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d)
[0m07:43:29.870090 [debug] [Thread-1 (]: Began compiling node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m07:43:29.877263 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m07:43:29.881025 [debug] [Thread-1 (]: Began executing node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m07:43:29.883526 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m07:43:29.886130 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"
[0m07:43:29.886667 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from STOCK.data.market_dat
where symbol is null



      
    ) dbt_internal_test
[0m07:43:29.887246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:30.285443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m07:43:30.290549 [debug] [Thread-1 (]: On test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d: Close
[0m07:43:30.450428 [info ] [Thread-1 (]: 7 of 7 PASS source_not_null_stock_data_source_market_dat_symbol ................ [[32mPASS[0m in 0.58s]
[0m07:43:30.453336 [debug] [Thread-1 (]: Finished running node test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d
[0m07:43:30.456263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:30.457009 [debug] [MainThread]: Connection 'test.stock_analysis_project.source_not_null_stock_data_source_market_dat_symbol.c1507f776d' was properly closed.
[0m07:43:30.457685 [info ] [MainThread]: 
[0m07:43:30.458741 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m07:43:30.461144 [debug] [MainThread]: Command end result
[0m07:43:30.581372 [info ] [MainThread]: 
[0m07:43:30.581982 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:30.582394 [info ] [MainThread]: 
[0m07:43:30.582842 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m07:43:30.583674 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.4827123, "process_user_time": 2.609307, "process_kernel_time": 0.220182, "process_mem_max_rss": "208792", "process_out_blocks": "1963", "process_in_blocks": "0"}
[0m07:43:30.584122 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:30.584050 after 7.48 seconds
[0m07:43:30.584471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86132b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d13fb90>]}
[0m07:43:30.584839 [debug] [MainThread]: Flushing usage events
[0m07:43:33.150695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa177e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36e9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2073320>]}


============================== 07:43:33.154832 | 131a53de-adde-4304-87fe-4543a30748f2 ==============================
[0m07:43:33.154832 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:43:33.155435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:33.554391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ad8ce0>]}
[0m07:43:33.578574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a6f560>]}
[0m07:43:33.579093 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:43:33.626592 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:43:33.706570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:33.706905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:33.709570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt.transformations
- models.dbt.marts
- models.dbt.raw
- snapshots.dbt
[0m07:43:33.732051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5f3800>]}
[0m07:43:33.795320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b931490>]}
[0m07:43:33.795795 [info ] [MainThread]: Found 3 models, 1 snapshot, 7 data tests, 1 source, 460 macros
[0m07:43:33.796225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b52eba0>]}
[0m07:43:33.797285 [info ] [MainThread]: 
[0m07:43:33.797778 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:43:33.798342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK'
[0m07:43:33.805890 [debug] [ThreadPool]: Using snowflake connection "list_STOCK"
[0m07:43:33.806228 [debug] [ThreadPool]: On list_STOCK: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK"} */
show terse schemas in database STOCK
    limit 10000
[0m07:43:33.806465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:34.484853 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.678 seconds
[0m07:43:34.488728 [debug] [ThreadPool]: On list_STOCK: Close
[0m07:43:34.612249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK, now list_stock_data)
[0m07:43:34.618373 [debug] [ThreadPool]: Using snowflake connection "list_stock_data"
[0m07:43:34.618889 [debug] [ThreadPool]: On list_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_stock_data"} */
show objects in stock.data limit 10000
[0m07:43:34.619218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:35.061927 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.443 seconds
[0m07:43:35.065405 [debug] [ThreadPool]: On list_stock_data: Close
[0m07:43:35.196977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_data, now list_STOCK_snapshots)
[0m07:43:35.202732 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_snapshots"
[0m07:43:35.203462 [debug] [ThreadPool]: On list_STOCK_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "connection_name": "list_STOCK_snapshots"} */
show objects in STOCK.snapshots limit 10000
[0m07:43:35.203949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:35.661435 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.457 seconds
[0m07:43:35.664592 [debug] [ThreadPool]: On list_STOCK_snapshots: Close
[0m07:43:35.795773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b30deb0>]}
[0m07:43:35.797094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:35.813055 [info ] [MainThread]: 
[0m07:43:35.824661 [debug] [Thread-1 (]: Began running node snapshot.stock_analysis_project.stock_snapshot
[0m07:43:35.825338 [info ] [Thread-1 (]: 1 of 1 START snapshot STOCK.snapshots.stock_snapshot ........................... [RUN]
[0m07:43:35.826160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_snapshots, now snapshot.stock_analysis_project.stock_snapshot)
[0m07:43:35.826536 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analysis_project.stock_snapshot
[0m07:43:35.832038 [debug] [Thread-1 (]: Began executing node snapshot.stock_analysis_project.stock_snapshot
[0m07:43:35.861748 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:35.862209 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
describe table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT"
[0m07:43:35.862527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:36.341416 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.479 seconds
[0m07:43:36.364579 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:36.365147 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
create or replace temporary table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        
    
    
    SELECT 
        date,
        symbol,
        open,
        high,
        low,
        close,
        volume,
        CONCAT(date, '_', symbol) AS date_symbol,
        CURRENT_TIMESTAMP AS updated_at
    FROM stock.data.stock_data

    ),

    snapshotted_data as (

        select *, 
    
        date_symbol as dbt_unique_key
    

        from "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date_symbol as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date_symbol as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date_symbol as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m07:43:37.577089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.212 seconds
[0m07:43:37.582632 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:37.583820 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
describe table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT__dbt_tmp"
[0m07:43:37.674548 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.090 seconds
[0m07:43:37.680593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:37.681409 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
describe table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT"
[0m07:43:37.792752 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m07:43:37.797541 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:37.797967 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
describe table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT__dbt_tmp"
[0m07:43:37.864640 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.066 seconds
[0m07:43:37.869359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:37.869766 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
describe table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT"
[0m07:43:37.954559 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.084 seconds
[0m07:43:37.963594 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:37.964060 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
describe table "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT__dbt_tmp"
[0m07:43:38.090559 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.126 seconds
[0m07:43:38.109275 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:38.109800 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    
    
    SELECT 
        date,
        symbol,
        open,
        high,
        low,
        close,
        volume,
        CONCAT(date, '_', symbol) AS date_symbol,
        CURRENT_TIMESTAMP AS updated_at
    FROM stock.data.stock_data

    ),

    snapshotted_data as (

        select *, 
    
        date_symbol as dbt_unique_key
    

        from "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date_symbol as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date_symbol as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date_symbol as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m07:43:38.580550 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.470 seconds
[0m07:43:38.589109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:38.589680 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:43:38.670497 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m07:43:38.671797 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:38.675555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:38.676439 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
BEGIN
[0m07:43:38.802441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m07:43:38.803666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:38.804423 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
merge into "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT" as DBT_INTERNAL_DEST
    using "STOCK"."SNAPSHOTS"."STOCK_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DATE_SYMBOL", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DATE_SYMBOL", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:43:39.604502 [debug] [Thread-1 (]: SQL status: SUCCESS 252 in 0.799 seconds
[0m07:43:39.605462 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analysis_project.stock_snapshot"
[0m07:43:39.606170 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt", "target_name": "dev", "node_id": "snapshot.stock_analysis_project.stock_snapshot"} */
COMMIT
[0m07:43:39.954171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m07:43:39.969731 [debug] [Thread-1 (]: On snapshot.stock_analysis_project.stock_snapshot: Close
[0m07:43:40.064816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131a53de-adde-4304-87fe-4543a30748f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b930740>]}
[0m07:43:40.066398 [info ] [Thread-1 (]: 1 of 1 OK snapshotted STOCK.snapshots.stock_snapshot ........................... [[32mSUCCESS 252[0m in 4.24s]
[0m07:43:40.068257 [debug] [Thread-1 (]: Finished running node snapshot.stock_analysis_project.stock_snapshot
[0m07:43:40.069958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:40.070319 [debug] [MainThread]: Connection 'snapshot.stock_analysis_project.stock_snapshot' was properly closed.
[0m07:43:40.070629 [info ] [MainThread]: 
[0m07:43:40.071229 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m07:43:40.071897 [debug] [MainThread]: Command end result
[0m07:43:40.145447 [info ] [MainThread]: 
[0m07:43:40.146076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:40.146485 [info ] [MainThread]: 
[0m07:43:40.146875 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:40.147622 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.0485034, "process_user_time": 2.229328, "process_kernel_time": 0.145347, "process_mem_max_rss": "206876", "process_out_blocks": "1940", "process_in_blocks": "0"}
[0m07:43:40.147996 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:43:40.147931 after 7.05 seconds
[0m07:43:40.148286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3540f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b756720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ad9550>]}
[0m07:43:40.148576 [debug] [MainThread]: Flushing usage events
